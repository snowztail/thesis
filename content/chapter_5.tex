%!TEX root = ../thesis.tex

\graphicspath{{assets/chapter_5/}}

\chapter{Channel Shaping using \glsfmtshort{ris}: From Diagonal Model to Beyond}\label{ch:channel_shaping}




\begin{section}{Introduction}
	% The quest for reliable, high-speed, and ubiquitous wireless connectivity has been long-standing since Marconi's illuminating radio in 1895.
	% Great successes have been made at transmitter and receiver sides over the past century, and the society is unprecedentedly close to the Shannon limit \cite{Shannon1948}.
	Today we are witnessing a paradigm shift from connectivity to intelligence, where the wireless environment is no longer a chaotic medium but a conscious agent that serves on demand.
	This is empowered by the recent advances in \gls{ris}, a real-time programmable metasurface of numerous non-resonant sub-wavelength scattering elements.
	It can manipulate the amplitude, phase, frequency, and polarization of the scattered waves \cite{Basar2019} with a higher energy efficiency, lower cost, lighter footprint, and greater scalability than relays.
	Using \gls{ris} for {passive beamforming} has attracted significant interest in wireless communication \cite{Wu2019,Wu2020c,Yang2020,Zheng2021}, backscatter \cite{Jia2020,Liang2022}, sensing \cite{Liu2022a,Hua2023}, and power transfer literature \cite{Wu2021d,Feng2022,Zhao2022}, reporting a second-order array gain and fourth-order power scaling law (with proper waveform).
	On the other hand, \gls{ris} also enables {backscatter modulation} by dynamically switching between different patterns, as already investigated \cite{Karasik2020,Basar2020,Zhao2022a} and prototyped \cite{Tang2019b,Dai2020a}.
	Despite fruitful outcomes, one critical unanswered question is the {channel shaping} capability: \emph{To what extent can a passive \gls{ris} reshape the wireless channel?}

	The answer depends heavily on the hardware architecture and scattering model.
	In diagonal \gls{ris}, each scattering element is tuned by a dedicated impedance and acts as an \emph{individual} phase shifter \cite{Wu2020}.
	The concept is generalized to \gls{bd}-\gls{ris} \cite{Shen2020a,Li2023b} which physically connects adjacent elements using passive components.
	This allows \emph{cooperative} scattering --- wave impinging on one element can propagate within the circuit and depart partially from any element in the same group.
	\gls{bd}-\gls{ris} can thus control both amplitude and phase of the reflected wave, generalizing the scattering matrix from diagonal with unit-magnitude entries \eqref{eq:diagonal_scattering_matrix} to block diagonal with unitary blocks \eqref{eq:bd_scattering_matrix}.
	Its benefit has been recently shown in receive power maximization \cite{Nerini2023,Santamaria2023,Fang2023,Nerini2024}, transmit power minimization \cite{Zhou2023}, and rate maximization \cite{Zhou2023,Nerini2024,Li2023d,Bartoli2023,Li2023c}.
	Practical issues such as channel estimation \cite{Li2023e} and mutual coupling \cite{Li2023f} have also been investigated.
	Therefore, \gls{bd}-\gls{ris} is envisioned as the next generation channel shaper with stronger signal processing flexibility \cite{Li2023g}.

	% Attempts to characterize the channel shaping capability can be classified into \emph{singular value centric} and \emph{power centric} methods.
	% Channel shaping is different from passive beamforming as it seeks to modify the inherent properties of the channel itself, allowing one to decouple \gls{ris} and transceiver design.
	Channel shaping is different from passive beamforming discussed in Chapters \ref{ch:ris_aided_swipt} and \ref{ch:riscatter} because \gls{ris} is exploited as a stand-alone device to modify the inherent properties of the wireless channel.
	This allows one to decouple the \gls{ris}-transceiver design and explore the fundamental limits of wave manipulation.
	Relevant design criteria can be roughly classified into two categories:
	\begin{itemize}
		\item \emph{Singular value centric:} Focus on the singular values of the equivalent channel matrix, which are closely related to the channel capacity and the diversity-multiplexing trade-off. Relevant designs are more complicated since they involve the entire channel matrix.
		\item \emph{Power centric:} Focus on the second-order characteristics of the channel matrix, which are useful in \gls{miso} but less informative in \gls{mimo}. Relevant designs are more practical and straightforward.
	\end{itemize}
	The former has been studied in terms of minimum singular value \cite{ElMossallamy2021}, effective rank \cite{ElMossallamy2021,Meng2023}, condition number \cite{Zheng2022,Huang2023} in \gls{pc}, and degree of freedom \cite{Bafghi2022,Zheng2023,Chae2023} in \gls{ic}.
	The latter has been studied in terms of channel power \cite{Wu2019,Nerini2023,Santamaria2023} in \gls{pc} and leakage interference \cite{Santamaria2023a} in \gls{ic}.
	Although the results are insightful, the big picture is far from complete since there exists neither a systematic channel shaping study nor a universal \gls{ris} optimization framework.
	To the best of our knowledge, the most general channel shaping scenario (\gls{bd}-\gls{ris}-aided \gls{mimo}) has not been studied, and the great potential of \gls{bd}-\gls{ris} has not been fully exploited or understood.
	This chapter aims for a comprehensive answer to the channel shaping question through theoretical analysis and numerical optimization.
	The contributions are summarized below.

	First, we exploit the Riemannian geometry of the Stiefel manifold to design a novel geodesic\footnote{A geodesic refers to the shortest path between two points in a Riemannian manifold.} \gls{rcg} algorithm for \gls{bd}-\gls{ris} optimization.
	This method modified from \cite{Abrudan2008,Abrudan2009} not only features lower complexity and faster convergence than general non-geodesic approach \cite{Absil2009,Pan2022d}, but also fits arbitrary group size and any smooth \gls{ris} optimization problem.
	Specifically, block-wise rotational update is performed along the geodesics of the Stiefel manifold, which are expressed compactly by the exponential map \cite{Edelman1998}.
	This is the first work to tailor an efficient optimization framework for asymmetric \gls{bd}-\gls{ris}.

	Second, we quantify the capability of a \gls{bd}-\gls{ris} to redistribute the singular values of \gls{mimo}-\gls{pc}.
	The \emph{Pareto frontiers} are characterized by optimizing the {weighted sum of singular values}, where the weights can be positive, zero, or negative.
	This problem is solved by the proposed geodesic \gls{rcg} algorithm.
	The resulting achievable singular value region generalizes most relevant metrics and provides an intuitive channel shaping benchmark.
	We also demystify the \gls{bd}-\gls{ris} gain from off-diagonal entries and derive some analytical singular value bounds for rank-deficient \gls{mimo} and fully-connected (a.k.a. unitary) \gls{ris}.
	This is the first work to comprehensively answer the channel shaping question and fully unveil the potential or \gls{bd}-\gls{ris}.

	Third, we tackle \gls{bd}-\gls{ris}-aided \gls{mimo}-\gls{pc} rate maximization with two solutions: a local-optimal approach through \gls{ao} and a low-complexity approach over channel shaping.
	The former updates active and passive beamforming by eigenmode transmission and \gls{rcg} algorithm, respectively.
	The latter suboptimally decouples both blocks, recasts the shaping problem as channel power maximization, and solves it iteratively in closed form.
	Interestingly, the gap in between vanishes as \gls{bd}-\gls{ris} evolves from diagonal to unitary.
	It suggests channel shaping decouples the \gls{ris}-transceiver design and offers a promising low-complexity solution.
	This is the first work to discuss the implications of channel shaping in joint active-passive beamforming optimization.

	Fourth, we extend the aforementioned approaches to \gls{mimo}-\gls{ic} where the \gls{bd}-\gls{ris} is used for leakage interference minimization and \gls{wsr} maximization.
	In the former case, we update the receive combiner, transmit precoder, and scattering matrix iteratively in closed forms with optimality proof.
	In the latter case, we alternatively updates the transmit precoder by bisection and the scattering matrix by \gls{rcg} algorithm.
	We also compare the impact of \gls{ris} on \gls{pc} and \gls{ic}.
	% provide a comprehensive comparison between the two approaches and discuss the implications of channel shaping in \gls{ic}.



	% Fifth, extensive simulations reveal that the performance gain from \gls{bd}-\gls{ris} increases with group size and \gls{mimo} dimensions.
	% In terms of channel power, fully-connected \gls{bd}-\gls{ris} boosts up to 62\% and 270\% over diagonal \gls{ris} in $1 \times 1$ and $4 \times 4$ \gls{mimo} under independent Rayleigh fading, respectively.
	% The superiority stems from stronger \emph{subchannel rearrangement} and \emph{subspace alignment} capabilities empowered by in-group cooperation.
	% It emphasizes the importance of using \gls{bd}-\gls{ris} in large-scale \gls{mimo} systems.


\end{section}


\begin{section}{\glsfmtshort{mimo}-\glsfmtshort{pc}}
	\begin{subsection}{System Model}
		Consider a \gls{bd}-\gls{ris}-aided point-to-point \gls{mimo} system with $N_\mathrm{T}$, $N_\mathrm{S}$, $N_\mathrm{R}$ transmit, scatter, and receive antennas, respectively.
		This configuration is denoted as $N_\mathrm{T} \times N_\mathrm{S} \times N_\mathrm{R}$ in the following context.
		The \gls{bd}-\gls{ris} can be modeled as an $N_\mathrm{S}$-port network \cite{Ivrlac2010} that divides into $G$ individual groups, each containing $L \triangleq N_\mathrm{S} / G$ elements interconnected by real-time reconfigurable components \cite{Shen2020a}.
		To simplify the analysis, we assume a lossless asymmetric network\footnote{While symmetric \gls{bd}-\gls{ris} (involving capacitors and inductors) is often considered in the literature \cite{Shen2020a,Nerini2023,Santamaria2023,Fang2023,Nerini2024,Zhou2023,Li2023d,Bartoli2023}, asymmetric \gls{bd}-\gls{ris} can be built over reconfigurable asymmetric passive components (e.g., ring hybrids and branch-line hybrids) \cite{Ahn2006}.} without mutual coupling between scatter elements, as previously considered in \cite{Li2023b,Li2023c,Bartoli2023}.
		The overall scattering matrix of the \gls{bd}-\gls{ris} is
		\begin{equation}
			\mathbf{\Theta} = \mathrm{diag}(\mathbf{\Theta}_1,\ldots,\mathbf{\Theta}_G),
		\end{equation}
		where $\mathbf{\Theta}_g \in \mathbb{U}^{L \times L}$ is a unitary matrix that describes the response of group $g \in \mathcal{G} \triangleq \{1, \ldots, G\}$.
		That is, $\mathbf{\Theta}_g^\mathsf{H} \mathbf{\Theta}_g = \mathbf{I}$.
		Note that diagonal (single-connected) and unitary (fully-connected) \gls{ris} can be regarded as its extreme cases with group size $L=1$ and $L=N_\mathrm{S}$, respectively.
		Some potential physical architectures of \gls{bd}-\gls{ris} are illustrated in \cite[Fig. 3]{Shen2020a}, \cite[Fig. 5]{Li2023c}, and \cite[Fig. 2]{Nerini2024}, where the radiation pattern and circuit topology have impacts on the scattering matrix.

		Let $\mathbf{H}_\mathrm{D} \in \mathbb{C}^{N_\mathrm{R} \times N_\mathrm{T}}$, $\mathbf{H}_\mathrm{B} \in \mathbb{C}^{N_\mathrm{R} \times N_\mathrm{S}}$, $\mathbf{H}_\mathrm{F} \in \mathbb{C}^{N_\mathrm{S} \times N_\mathrm{T}}$ denote the direct (transmitter-receiver), backward (\gls{ris}-receiver), and forward (transmitter-\gls{ris}) channels, respectively.
		The equivalent channel is a function of the scattering matrix
		\begin{equation}
			\mathbf{H} = \mathbf{H}_\mathrm{D} + \mathbf{H}_\mathrm{B} \mathbf{\Theta} \mathbf{H}_\mathrm{F} = \mathbf{H}_\mathrm{D} + \sum_g \mathbf{H}_{\mathrm{B},g} \mathbf{\Theta}_g \mathbf{H}_{\mathrm{F},g},
			\label{eq:channel_equivalent}
		\end{equation}
		where $\mathbf{H}_{\mathrm{B},g} \in \mathbb{C}^{N_\mathrm{R} \times L}$ and $\mathbf{H}_{\mathrm{F},g} \in \mathbb{C}^{L \times N_\mathrm{T}}$ are the backward and forward subchannels for \gls{ris} group $g$, corresponding to the $(g-1)L$ to $gL$ columns of $\mathbf{H}_\mathrm{B}$ and rows of $\mathbf{H}_\mathrm{F}$, respectively.
		% That is, $\mathbf{H}_{\mathrm{B},g}$ (resp. $\mathbf{H}_{\mathrm{F},g}$) corresponds to the $(g-1)L$ to $gL$ columns (resp. rows) of $\mathbf{H}_\mathrm{B}$ (resp. $\mathbf{H}_\mathrm{F}$).
		% , corresponding to the $(g-1)L$ to $gL$ columns of $\mathbf{H}_\mathrm{B}$ and rows of $\mathbf{H}_\mathrm{F}$.
		% $\mathbf{H}_{\mathrm{B},g}$ (resp. $\mathbf{H}_{\mathrm{F},g}$) corresponds to the $(g-1)L$ to $gL$ columns of $\mathbf{H}_\mathrm{B}$
		Since unitary matrices constitute an algebraic group with respect to multiplication, the scattering matrix of group $g$ can be decomposed as
		\begin{equation}
			\mathbf{\Theta}_g = \mathbf{L}_g \mathbf{R}_g^\mathsf{H},
			\label{eq:unitary_decomposition}
		\end{equation}
		where $\mathbf{L}_g, \mathbf{R}_g \in \mathbb{U}^{L \times L}$ are two unitary factor matrices.
		Let $\mathbf{H}_{\mathrm{B},g} = \mathbf{U}_{\mathrm{B},g} \mathbf{\Sigma}_{\mathrm{B},g} \mathbf{V}_{\mathrm{B},g}^\mathsf{H}$ and $\mathbf{H}_{\mathrm{F},g} = \mathbf{U}_{\mathrm{F},g} \mathbf{\Sigma}_{\mathrm{F},g} \mathbf{V}_{\mathrm{F},g}^\mathsf{H}$ be the compact \gls{svd} of the backward and forward channels, respectively.
		The equivalent channel can thus be rewritten as
		\begin{equation}
			\mathbf{H} = \overbrace{\mathbf{H}_\mathrm{D} + \sum_g \mathbf{U}_{\mathrm{B},g} \mathbf{\Sigma}_{\mathrm{B},g} \underbrace{\mathbf{V}_{\mathrm{B},g}^\mathsf{H} \mathbf{L}_g \mathbf{R}_g^\mathsf{H} \mathbf{U}_{\mathrm{F},g}}_\text{backward-forward} \mathbf{\Sigma}_{\mathrm{F},g} \mathbf{V}_{\mathrm{F},g}^\mathsf{H}}^\text{direct-indirect}.
			\label{eq:channel_equivalent_svd}
		\end{equation}

		\begin{remark}\label{rm:channel_shaping}
			By analyzing \eqref{eq:channel_equivalent_svd}, we conclude that channel shaping through \gls{bd}-\gls{ris} creates two critical opportunities:
			\begin{itemize}
				\item \textbf{Subspace alignment:} Each group can align the singular matrices of the backward-forward (intra-group, multiplicative) and the direct-indirect (inter-group, additive) channels. In \gls{siso}, subspace alignment boils down to phase matching and the optimal scattering matrix of group $g$ is
				\begin{equation}
					\mathbf{\Theta}_g^\star = \exp \bigl(\jmath \mathrm{arg}(h_\mathrm{D})\bigr) \mathbf{V}_{\mathrm{B},g} \mathbf{U}_{\mathrm{F},g}^\mathsf{H},
				\end{equation}
				where $\mathbf{V}_{\mathrm{B},g} = \bigl[\mathbf{h}_{\mathrm{B},g}/\lVert \mathbf{h}_{\mathrm{B},g} \rVert, \mathbf{N}_{\mathrm{B},g}\bigr]$, $\mathbf{U}_{\mathrm{F},g} = \bigl[\mathbf{h}_{\mathrm{F},g}/\lVert \mathbf{h}_{\mathrm{F},g} \rVert, \mathbf{N}_{\mathrm{F},g}\bigr]$, and $\mathbf{N}_{\mathrm{B},g}, \mathbf{N}_{\mathrm{F},g} \in \mathbb{C}^{L \times (L-1)}$ are the orthonormal bases of the null spaces of $\mathbf{h}_{\mathrm{B},g}$ and $\mathbf{h}_{\mathrm{F},g}$, respectively.
				Diagonal \gls{ris} is thus sufficient for perfect \gls{siso} phase matching (with empty null spaces), but its disadvantage in subspace alignment scales with \gls{mimo} dimensions, since each element can only apply a common phase shift to the ``pinhole'' indirect channel of size $N_\mathrm{R} \times N_\mathrm{T}$ passing through itself.
				Even if the \gls{bd}-\gls{ris} is fully-connected, there still exists a trade-off between the direct-indirect and backward-forward alignments.
				\item \textbf{Subchannel rearrangement:} This unique property of \gls{bd}-\gls{ris} allows each group to rearrange and combine the backward and forward subchannels by strength. In \gls{siso}, diagonal \gls{ris} provides a maximum indirect channel amplitude of $\sum_{n=1}^{N_\mathrm{S}} \lvert h_{\mathrm{B},n} \rvert \lvert h_{\mathrm{F},n} \rvert$, while \gls{bd}-\gls{ris} can generalize it to $\sum_{g=1}^{G} \sum_{l=1}^{L} \lvert h_{\mathrm{B},\pi_{\mathrm{B},g}(l)} \rvert \lvert h_{\mathrm{F},\pi_{\mathrm{F},g}(l)} \rvert$, where $\pi_{\mathrm{B},g}$ and $\pi_{\mathrm{F},g}$ are permutations of $\mathcal{L} \triangleq \{1, \ldots, L\}$. By rearrangement inequality, the maximum is attained by pairing the $l$-th strongest backward and forward subchannels in each group.
				The advantage of \gls{bd}-\gls{ris} in subchannel rearrangement scales with \gls{mimo} dimensions, since the number of subchannels associated with each group grows with $N_\mathrm{R} \times N_\mathrm{T}$.
			\end{itemize}
		\end{remark}

		% TODO: add illustrations for both

		% In \gls{siso}, the equivalent channel can be further simplified as
		% \begin{equation}
		% 	h = h_\mathrm{D} + \sum_g \mathbf{h}_{\mathrm{B},g} \mathbf{\Theta}_g \mathbf{h}_{\mathrm{F},g},
		% \end{equation}
		% subspace alignment boils down to phase matching




		% For the \gls{siso} case in Fig. \subref*{fg:power_bond_txrx1_nd}, the maximum channel power is approximately \num{4e-6} by diagonal \gls{ris} and \num{6.5e-6} by fully-connected \gls{bd}-\gls{ris}, corresponding to a \qty{62.5}{\percent} gain.
		% This aligns with the asymptotic \gls{bd}-\gls{ris} scaling law derived for \gls{siso} in \cite{Shen2020a}.
		% Interestingly, the gain surges to \qty{270}{\percent} in 4T4R \gls{mimo} as shown in Fig. \subref*{fg:power_bond_txrx4_nd}.
		% This is because subspace alignment boils down to phase matching in \gls{siso} such that both triangular and Cauchy-Schwarz inequalities in \cite[(50)]{Shen2020a} can be simultaneously tight regardless of the group size.
		% That is, diagonal \gls{ris} is sufficient for subspace alignment in \gls{siso} while the \qty{62.5}{\percent} gain from \gls{bd}-\gls{ris} comes purely from subchannel rearrangement (i.e., pairing the forward and backward channels from strongest to weakest).
		% Now consider a diagonal \gls{ris} in \gls{mimo}.
		% Each element can only apply a common phase shift to the associated rank-1 $N_\mathrm{R} \times N_\mathrm{T}$ indirect channel.
		% Therefore, perfect subspace alignment of indirect channels through different elements is generally impossible.
		% It means the disadvantage of diagonal \gls{ris} in subspace alignment and subchannel rearrangement scales with \gls{mimo} dimensions.
		% We thus conclude that the power gain of \gls{bd}-\gls{ris} scales with group size and \gls{mimo} dimensions.


		% \begin{equation}
		% 	\mathbf{H} = \underbrace{\mathbf{H}_\mathrm{D} + \underbrace{\sum_g \mathbf{U}_{\mathrm{B},g} \mathbf{\Sigma}_{\mathrm{B},g} \underbrace{\mathbf{V}_{\mathrm{B},g}^\mathsf{H} \mathbf{L}_g \mathbf{R}_g^\mathsf{H} \mathbf{U}_{\mathrm{F},g}}_\text{backward-forward} \mathbf{\Sigma}_{\mathrm{F},g} \mathbf{V}_{\mathrm{F},g}^\mathsf{H}}_\text{group-wise}}_\text{direct-indirect},
		% \end{equation}
		% which involves three subspace alignment problems:
		% which involves three subspace alignment problems
		% \begin{equation}
		% 	\mathbf{H} = \mathbf{H}_\mathrm{D} + \sum_g \mathbf{U}_{\mathrm{B},g} \mathbf{\Sigma}_{\mathrm{B},g} \underbrace{\mathbf{V}_{\mathrm{B},g}^\mathsf{H} \mathbf{L}_g \mathbf{R}_g^\mathsf{H} \mathbf{U}_{\mathrm{F},g}}_{\substack{\text{backward-forward}\\\text{additive alignment}}} \mathbf{\Sigma}_{\mathrm{F},g} \mathbf{V}_{\mathrm{F},g}^\mathsf{H}.
		% \end{equation}
		% \begin{equation}
		% 	\mathbf{H} = \mathbf{H}_\mathrm{D} + \sum_g \mathbf{U}_{\mathrm{B},g} \mathbf{\Sigma}_{\mathrm{B},g} \underbrace{\mathbf{V}_{\mathrm{B},g}^\mathsf{H} \mathbf{L}_g}_{\substack{\text{backward}\\\text{align}}} \underbrace{\mathbf{R}_g^\mathsf{H} \mathbf{U}_{\mathrm{F},g}}_{\substack{\text{forward}\\\text{align}}} \mathbf{\Sigma}_{\mathrm{F},g} \mathbf{V}_{\mathrm{F},g}^\mathsf{H}.
		% \end{equation}
		% Then the equivalent channel can be rewritten as
		% Since the field of (block) unitary matrices formulate a field that is closed under multiplication
		% Since block unitary matrices satisfy the axioms of a field under matrix multiplication
		% \begin{remark}
		% 	% To understand the \gls{b} gain from in-group connections
		% \end{remark}




		% \begin{remark}
		% 	From \eqref{eq:scattering_fc} and \eqref{eq:channel_equivalent_fc} in the proof of Proposition \ref{pp:fully_connected}, we notice that \eqref{iq:sv_bound_fc}--\eqref{iq:sv_bound_fc_power} are simultaneously tight when
		% 	% Interestingly, \eqref{iq:sv_bound_fc}--\eqref{iq:sv_bound_fc_power} are simultaneously tight when
		% 	\begin{equation}
		% 		\mathbf{\Theta} = \mathbf{V}_\mathrm{B} \mathbf{U}_\mathrm{F}^\mathsf{H}.
		% 		\label{eq:scattering_fc_tight}
		% 	\end{equation}
		% 	An interpretation is that the off-diagonal entries can enhance the capabilities of
		% 	\begin{itemize}
		% 		\item subspace alignment: $\mathbf{V}_\mathrm{B}$ and $\mathbf{U}_\mathrm{F}^\mathsf{H}$ in \eqref{eq:scattering_fc} fully align the subspaces of $\mathbf{H}_\mathrm{B}$ and $\mathbf{H}_\mathrm{F}$ by rotation;
		% 		\item subchannel rearrangement: $\mathbf{X} = \mathbf{I}$ in \eqref{eq:channel_equivalent_fc} pairs the subchannels of $\mathbf{H}_\mathrm{B}$ and $\mathbf{H}_\mathrm{F}$ from strongest to weakest, which attains the maximum in rearrangement inequality.
		% 	\end{itemize}
		% \end{remark}



		% \begin{remark}
		% 	\gls{bd}-\gls{ris} reduces to diagonal \gls{ris} and unitary \gls{ris} with group size $L$ 1 and $N_\mathrm{S}$, respectively.
		% \end{remark}
		% \begin{remark}
		% 	Individual forward and backward \gls{csi} are required for \gls{bd}-\gls{ris} designs.
		% 	This is different from diagonal \gls{ris} where estimating their product is usually sufficient.
		% 	% Later we will show the potential benefits from the \gls{csi} overhead.
		% \end{remark}
	\end{subsection}


	\begin{subsection}{Channel Singular Values Redistribution}
		\begin{subsubsection}{A Toy Example}\label{sc:toy_example}
			We first illustrate the channel shaping capabilities of different \gls{ris} by a toy example.
			% We first use a toy example to illustrate that \gls{bd}-\gls{ris} can provide a wider dynamic range of channel singular values.
			Consider a $2 \times 2 \times 2$ setup where the direct link is blocked.
			The diagonal \gls{ris} is modeled by $\mathbf{\Theta}_\mathrm{D} = \mathrm{diag}(e^{\jmath \theta_1}, e^{\jmath \theta_2})$ while the unitary \gls{bd}-\gls{ris} has 4 independent angular parameters
			\begin{equation}
				\mathbf{\Theta}_\mathrm{U} = e^{\jmath \phi} \begin{bmatrix}
					e^{\jmath \alpha} \cos \psi  & e^{\jmath \beta} \sin \psi   \\
					-e^{-\jmath \beta} \sin \psi & e^{-\jmath \alpha} \cos \psi
				\end{bmatrix}.
			\end{equation}
			It is worth noting that $\phi$ has no impact on the singular value because $\mathrm{sv}(e^{\jmath \phi} \mathbf{A}) = \mathrm{sv}(\mathbf{A})$.
			For a fair comparison, we also enforce symmetry $\mathbf{\Theta}_\mathrm{U} = \mathbf{\Theta}_\mathrm{U}^\mathsf{T}$ by $\beta = \pi / 2$ such that both architectures have the same number of angular parameters.
			\begin{figure}
				\centering
				\includegraphics[width=\columnwidth]{assets/chapter_5/singular_trend.eps}
				\caption{$2 \times 2 \times 2$ (no direct) channel singular value shaping by diagonal and symmetry unitary \gls{ris}.}
				\label{fg:singular_trend}
			\end{figure}
			Fig.~\ref{fg:singular_trend} shows the channel singular values achieved by an exhaustive grid search over $(\theta_1, \theta_2)$ for diagonal \gls{ris} and $(\alpha, \psi)$ for symmetric unitary \gls{ris}.
			It is observed that both singular values can be manipulated up to $9\%$ using diagonal \gls{ris} and $42\%$ using symmetric \gls{bd}-\gls{ris}, despite both architectures have the same number of scattering elements and design parameters.
			A larger performance gap is expected when asymmetric \gls{bd}-\gls{ris} is available.
			This example shows \gls{bd}-\gls{ris} can provide a wider dynamic range of channel singular values and motivates further studies on channel shaping.
		\end{subsubsection}

		\begin{subsubsection}{Pareto Frontier Characterization}\label{sc:pareto_frontier}
			We then characterize the Pareto frontier of channel singular values by maximizing their weighted sum
			\begin{maxi!}
				{\scriptstyle{\mathbf{\Theta}}}{\sum_n \rho_n \sigma_n(\mathbf{H})}{\label{op:pareto}}{\label{ob:pareto}}
				\addConstraint{\mathbf{\Theta}_g^\mathsf{H} \mathbf{\Theta}_g=\mathbf{I},}{\quad \forall g,}{\label{co:pareto_unitary}}
			\end{maxi!}
			where $n \in \{1,\ldots,N \triangleq \min(N_\mathrm{T}, N_\mathrm{R})\}$ and $\rho_n$ is the weight of the $n$-th singular value that can be positive, zero, or negative.
			Varying $\{\rho_n\}$ unveils the entire achievable singular value region.
			Thus, we claim the Pareto frontier problem~\eqref{op:pareto} generalizes most relevant metrics and provides a powerful shaping framework.
			The objective \eqref{ob:pareto} is smooth in $\mathbf{\Theta}$ and the feasible domain \eqref{co:pareto_unitary} for group $g$ corresponds to the Stiefel manifold.
			Next, we zoom out and provide an efficient optimization framework for asymmetric \gls{bd}-\gls{ris}.

			Inspired by \cite{Abrudan2008,Abrudan2009}, we propose a block-wise \gls{rcg} algorithm along the geodesics on the Lie group of unitary matrices $\mathbb{U}^{L \times L}$.
			It leverages the fact that unitary matrices are closed under multiplication.
			At iteration $r$, the gradient is computed in the Euclidean space and translated to the Riemannian manifold \cite{Absil2009}
			\begin{gather}
				\nabla_{\mathrm{E},g}^{(r)} = \frac{\partial f(\mathbf{\Theta}_g^{(r)})}{\partial \mathbf{\Theta}_g^*},\label{eq:gradient_euclidean}\\
				\nabla_{\mathrm{R},g}^{(r)} = \nabla_{\mathrm{E},g}^{(r)} {\mathbf{\Theta}_g^{(r)}}^\mathsf{H} - \mathbf{\Theta}_g^{(r)} {\nabla_{\mathrm{E},g}^{(r)}}^\mathsf{H}.\label{eq:gradient_riemannian} % $\mathcal{O}(N_\mathrm{S}^3)$
			\end{gather}
			The Polak-Ribierre parameter \cite{Polak1969} is approximated as \cite{Abrudan2009}
			\begin{equation}
				\gamma_g^{(r)} = \frac{\mathrm{tr}\bigl((\nabla_{\mathrm{R},g}^{(r)} - \nabla_{\mathrm{R},g}^{(r-1)}) {\nabla_{\mathrm{R},g}^{(r)}}^\mathsf{H}\bigr)}{\mathrm{tr}\bigl(\nabla_{\mathrm{R},g}^{(r-1)} {\nabla_{\mathrm{R},g}^{(r-1)}}^\mathsf{H}\bigr)}, % $\mathcal{O}(2 N_\mathrm{S}^3 + N_\mathrm{S}^2 + 2 N_\mathrm{S})$
				\label{eq:parameter_cg}
			\end{equation}
			and the conjugate direction is
			\begin{equation}
				\mathbf{D}_g^{(r)} = \nabla_{\mathrm{R},g}^{(r)} + \gamma_g^{(r)} \mathbf{D}_g^{(r-1)}. % $\mathcal{O}(N_\mathrm{S}^2)$
				\label{eq:direction_cg}
			\end{equation}
			In the Stiefel manifold, the geodesic emanating from $\mathbf{\Theta}_g^{(r)}$ with velocity $\mathbf{D}_g^{(r)}$ and step size $\mu$ is described compactly by the exponential map \cite{Edelman1998}
			\begin{equation}
				\mathbf{G}_g^{(r)}(\mu) = \exp(\mu \mathbf{D}_g^{(r)}) \mathbf{\Theta}_g^{(r)}. % $\mathcal{O}(N_\mathrm{S}^3)$
				\label{eq:geodesic}
			\end{equation}
			An appropriate $\mu^\star$ can be obtained by the Armijo rule \cite{Armijo1966}.
			To double the step size, one can simply square the rotation matrix instead of recomputing the matrix exponential, i.e., $\exp(2 \mu \mathbf{D}_g^{(r)}) = \exp^2(\mu \mathbf{D}_g^{(r)})$.
			To halve the step size, taking its square root is sufficient in theory but is subject to numerical instability in practice.
			Finally, the scattering matrix is updated along the geodesic as
			\begin{equation}
				\mathbf{\Theta}_g^{(r+1)} = \mathbf{G}_g^{(r)}(\mu^\star).
				\label{eq:update_geodesic}
			\end{equation}
			Algorithm~\ref{ag:rcg} summarizes the proposed block-wise geodesic \gls{rcg} method for smooth maximization problems of asymmetric \gls{bd}-\gls{ris}.
			Convergence to stationary points is guaranteed.

			\begin{remark}
				Compared with universal manifold optimization \cite{Absil2009,Pan2022d}, Algorithm~\ref{ag:rcg} inherits a trifold benefit from \cite{Abrudan2008,Abrudan2009}:
				\begin{enumerate}
					\item No retraction from Euclidean space to Stiefel manifold thanks to rotational update \eqref{eq:geodesic}, \eqref{eq:update_geodesic};
					\item Lower computational complexity per iteration;
					\item Faster convergence thanks to proper parameter space.
				\end{enumerate}
			\end{remark}

			% \setalgorithmcaptionfont{\small}
			\begin{algorithm}[!t]
				% \small
				\caption{Block-wise geodesic \gls{rcg} for asymmetric \gls{bd}-\gls{ris}}
				\label{ag:rcg}
				\begin{algorithmic}[1]
					\Require $f(\mathbf{\Theta})$, $G$
					\Ensure $\mathbf{\Theta}^\star$
					\Initialize {$r \gets 0$, $\mathbf{\Theta}^{(0)}$}
					\Repeat
						\For {$g \gets 1$ to $G$}
							\State $\nabla_{\mathrm{E},g}^{(r)} \gets$ \eqref{eq:gradient_euclidean} \label{ln:gradient_euclidean}
							\State $\nabla_{\mathrm{R},g}^{(r)} \gets$ \eqref{eq:gradient_riemannian}
							\State $\gamma_g^{(r)} \gets$ \eqref{eq:parameter_cg}
							\State $\mathbf{D}_g^{(r)} \gets$ \eqref{eq:direction_cg}
							\If {$\Re\bigl\{\mathrm{tr}({\mathbf{D}_g^{(r)}}^\mathsf{H} \nabla_{\mathrm{R},g}^{(r)})\bigr\} < 0$} \Comment{not an ascent direction}
								\State $\mathbf{D}_g^{(r)} \gets \nabla_{\mathrm{R},g}^{(r)}$
							\EndIf
							\State $\mu \gets 1$
							\State $\mathbf{G}_g^{(r)}(\mu) \gets$ \eqref{eq:geodesic}
							\While {$f\bigl(\mathbf{G}_g^{(r)}(2\mu)\bigr) - f(\mathbf{\Theta}_g^{(r)}) \ge \mu \cdot \mathrm{tr}(\mathbf{D}_g^{(r)} {\mathbf{D}_g^{(r)}}^\mathsf{H}) / 2$}
								\State $\mu \gets 2 \mu$
							\EndWhile
							\While {$f\bigl(\mathbf{G}_g^{(r)}(\mu)\bigr) - f(\mathbf{\Theta}_g^{(r)}) < \mu / 2 \cdot \mathrm{tr}(\mathbf{D}_g^{(r)} {\mathbf{D}_g^{(r)}}^\mathsf{H}) / 2$}
								\State $\mu \gets \mu / 2$
							\EndWhile
							\State $\mathbf{\Theta}_g^{(r+1)} \gets$ \eqref{eq:update_geodesic}
						\EndFor
						\State $r \gets r+1$
					\Until $\lvert f(\mathbf{\Theta}^{(r)}) - f(\mathbf{\Theta}^{(r-1)}) \rvert / f(\mathbf{\Theta}^{(r-1)}) \le \epsilon$
				\end{algorithmic}
			\end{algorithm}

			\begin{lemma}\label{lm:pareto_gradient}
				The Euclidean gradient of \eqref{ob:pareto} with respect to \gls{bd}-\gls{ris} group $g$ is
				\begin{equation}
					\frac{\partial \sum_n \rho_n \sigma_n(\mathbf{H})}{\partial \mathbf{\Theta}_g^*} = \mathbf{H}_{\mathrm{B},g}^\mathsf{H} \mathbf{U} \mathrm{diag}(\rho_1,\ldots,\rho_N) \mathbf{V}^\mathsf{H} \mathbf{H}_{\mathrm{F},g}^\mathsf{H},
					\label{eq:pareto_gradient}
				\end{equation}
				where $\mathbf{U}$ and $\mathbf{V}$ are the left and right singular matrices of $\mathbf{H}$, respectively.
			\end{lemma}
			\begin{proof}
				Please refer to Appendix~\ref{ap:pareto_gradient}.
			\end{proof}

			%  The Euclidean gradient of \gls{bd}-\gls{ris} group $g$ is computed as
			% where $\mathbf{U} \in \mathbb{C}^{N_\mathrm{R} \times N}$ and $\mathbf{V} \in \mathbb{C}^{N_\mathrm{T} \times N}$ are the left and right compact singular matrices of $\mathbf{H}$, respectively.
			Algorithm~\ref{ag:rcg} can thus be invoked for the Pareto singular value problem \eqref{op:pareto} where line \ref{ln:gradient_euclidean} uses \eqref{eq:pareto_gradient} explicitly.
			% \eqref{eq:pareto_gradient} is used in line \ref{ln:gradient_euclidean}.
		\end{subsubsection}

		\begin{subsubsection}{Some Analytical Bounds}\label{sc:bounds}
			We then discuss some interesting analytical bounds related to channel singular values.
			\begin{proposition}[Degree of freedom]\label{pp:dof}
				In point-to-point \gls{mimo}, \gls{bd}-\gls{ris} cannot achieve a higher \gls{dof} than diagonal \gls{ris}.
			\end{proposition}
			\begin{proof}
				Please refer to Appendix~\ref{ap:dof}.
			\end{proof}

			\begin{proposition}[Rank-deficient channel]\label{pp:rank_deficient}
				% If the forward/backward channel is rank-$k$, then a \gls{bd}-\gls{ris} can at most enlarge the $n$-th ($n > k$) channel singular value to the $n-k$-th singular value of $\mathbf{T}$, or suppress the $n$-th ($n < N - k + 1$) channel singular value to the $n$-th singular value of $\mathbf{T}$.
				% If the forward/backward channel is rank-$k$, then a sufficiently large \gls{bd}-\gls{ris} can at most enlarge (resp. suppress) the first (resp. last) $k$ equivalent channel singular values without bounds.
				If the forward or backward channel is rank-$k$, then regardless of the \gls{ris} size and architecture, the $n$-th singular value of the equivalent channel is bounded by
				\begin{align}
					\sigma_n(\mathbf{H}) & \le \sigma_{n-k}(\mathbf{T}), &  & \text{if } n > k, \label{iq:sv_bound_enlarge}          \\
					\sigma_n(\mathbf{H}) & \ge \sigma_n(\mathbf{T}),     &  & \text{if } n < N - k + 1, \label{iq:sv_bound_suppress}
				\end{align}
				where
				% \begin{align}
				% 	\mathbf{T} \mathbf{T}^\mathsf{H} = \mathbf{H}_\mathrm{D} (\mathbf{I} - \mathbf{V}_\mathrm{F} \mathbf{V}_\mathrm{F}^\mathsf{H}) \mathbf{H}_\mathrm{D}^\mathsf{H}, & \text{if } \mathrm{rank}(\mathbf{H}_\mathrm{F}) = k, \\
				% 	\mathbf{T}^\mathsf{H} \mathbf{T} = \mathbf{H}_\mathrm{D}^\mathsf{H} (\mathbf{I} - \mathbf{U}_\mathrm{F} \mathbf{U}_\mathrm{F}^\mathsf{H}) \mathbf{H}_\mathrm{D}, & \text{if } \mathrm{rank}(\mathbf{H}_\mathrm{B}) = k.
				% \end{align}
				\begin{equation}
					\mathbf{T} \mathbf{T}^\mathsf{H} =
					\begin{cases}
						\mathbf{H}_\mathrm{D} (\mathbf{I} - \mathbf{V}_\mathrm{F} \mathbf{V}_\mathrm{F}^\mathsf{H}) \mathbf{H}_\mathrm{D}^\mathsf{H}, & \text{if } \mathrm{rank}(\mathbf{H}_\mathrm{F}) = k, \\
						\mathbf{H}_\mathrm{D}^\mathsf{H} (\mathbf{I} - \mathbf{U}_\mathrm{B} \mathbf{U}_\mathrm{B}^\mathsf{H}) \mathbf{H}_\mathrm{D}, & \text{if } \mathrm{rank}(\mathbf{H}_\mathrm{B}) = k,
					\end{cases}
					\label{eq:auxiliary_matrix}
				\end{equation}
				and $\mathbf{V}_\mathrm{F}$ and $\mathbf{U}_\mathrm{B}$ are the right and left compact singular matrices of $\mathbf{H}_\mathrm{F}$ and $\mathbf{H}_\mathrm{B}$, respectively.
				% where $\mathbf{T} \mathbf{T}^\mathsf{H} = \mathbf{H}_\mathrm{D} (\mathbf{I} - \mathbf{V}_\mathrm{F} \mathbf{V}_\mathrm{F}^\mathsf{H}) \mathbf{H}_\mathrm{D}$ if the forward channel is rank-$k$ and $\mathbf{T}^\mathsf{H} \mathbf{T} = \mathbf{H}_\mathrm{D} (\mathbf{I} - \mathbf{U}_\mathrm{F} \mathbf{U}_\mathrm{F}^\mathsf{H}) \mathbf{H}_\mathrm{D}$ if the backward channel is rank-$k$.
			\end{proposition}
			\begin{proof}
				Please refer to Appendix~\ref{ap:rank_deficient}.
			\end{proof}

			% \begin{corollary}[degree of freedom]
			% 	In point-to-point \gls{mimo} with or without direct link, \gls{bd}-\gls{ris} cannot provide a higher \gls{dof} than diagonal \gls{ris}.
			% \end{corollary}

			\begin{corollary}[Extreme singular values\label{co:extreme}]
				With a sufficiently large \gls{ris}, the first $k$ channel singular values are unbounded above \footnote{\textellipsis while respecting energy conservation law $\sum_n \sigma_n^2 \le 1$. This constraint is omitted in the following context.} while the last $k$ channel singular values can be suppressed to zero.
				% For a rank-$k$ forward or backward channel with a sufficiently large \gls{ris}, the first $k$ singular values of the equivalent channel are unbounded above while the last $k$ singular values can be suppressed to zero.
				% If the forward or backward channel is rank-$k$ and the \gls{ris} is sufficiently large, then the first $k$ singular values of the equivalent channel are unbounded above while the last $k$ singular values can be suppressed to zero.
				% If the forward/backward channel is rank-$k$, then the first (resp. last) $k$ singular values of the equivalent channel are unbounded above (resp. below).
				% a sufficiently large \gls{ris} can at most enlarge (resp. suppress) the first (resp. last) $k$ singular values of the equivalent channel without bounds.
			\end{corollary}

			\begin{corollary}[\gls{los} channel\footnote{A similar result has been derived for diagonal \gls{ris} in \cite{Semmler2023}.}\label{co:los}]
				If the forward or backward channel is \gls{los}, then a \gls{ris} can at most enlarge (resp. suppress) the $n$-th ($n \ge 2$) channel singular value to the $(n-1)$-th (resp. $n$-th) singular value of $\mathbf{T}$, that is,
				\begin{equation}
					\sigma_1(\mathbf{H}) \ge \sigma_1(\mathbf{T}) \ge {\sigma_2(\mathbf{H})} \ge \ldots \ge \sigma_{N-1}(\mathbf{T}) \ge {\sigma_N(\mathbf{H})} \ge \sigma_N(\mathbf{T}).
					\label{iq:sv_bound_los}
				\end{equation}
			\end{corollary}

			In Section~\ref{sc:simulation}, we will show by simulation that a finite-size \gls{bd}-\gls{ris} can approach those bounds better than diagonal \gls{ris}.

			\begin{proposition}[Fully-connected \gls{ris} without direct link]\label{pp:fully_connected}
				% If the \gls{bd}-\gls{ris} is fully-connected and the direct link is absent, then the singular value bounds on $\mathbf{H}$ are equivalent to the singular value bounds on $\mathbf{BF}$, where $\mathbf{B}$ and $\mathbf{F}$ are arbitrary matrices with the same singular values as $\mathbf{H}_\mathrm{B}$ and $\mathbf{H}_\mathrm{F}$, respectively,
				If the \gls{bd}-\gls{ris} is fully-connected and the direct link is absent, then the channel singular values can be manipulated up to
				% If the \gls{bd}-\gls{ris} is fully-connected and the direct link is absent, then the bounds on the channel singular values are equivalent to the singular values of the equivalent channel, that is,
				% only bounds that apply here are those that apply to the singular values of
				\begin{equation}
					\mathrm{sv}(\mathbf{H}) = \mathrm{sv}(\mathbf{BF}),
				\end{equation}
				where $\mathbf{B}$ and $\mathbf{F}$ are arbitrary matrices with the same singular values as $\mathbf{H}_\mathrm{B}$ and $\mathbf{H}_\mathrm{F}$, respectively,
				% Our focus thus shifts to how the singular values of matrix product are bounded by the singular values of its individual factors.
			\end{proposition}

			\begin{proof}
				Please refer to Appendix~\ref{ap:fully_connected}.
			\end{proof}

			The problem now becomes \emph{how the singular values of matrix product are bounded by the singular values of its individual factors.}
			Let $N' = \max(N_\mathrm{T},N_\mathrm{S},N_\mathrm{R})$ and $\sigma_n(\mathbf{H})=\sigma_n(\mathbf{H}_\mathrm{F})=\sigma_n(\mathbf{H}_\mathrm{B})=0$ for $N < n \le N'$.
			We have the following corollaries.

			\begin{corollary}[Generic singular value bounds]
				\begin{equation}
					\prod_{k \in {K}} \sigma_k(\mathbf{H}) \le \prod_{i \in {I}} \sigma_i(\mathbf{H}_\mathrm{B}) \prod_{j \in {J}} \sigma_j(\mathbf{H}_\mathrm{F}),
					\label{iq:sv_bound_fc}
				\end{equation}
				for all admissible triples $(I, J, K) \in T_r^{N'}$ with $r < N'$, where
				\begin{equation*}
					\begin{gathered}
						% T_r^{N'} \triangleq \Bigl\{(I, J, K) \in U_r^{N'} \mid \text{for all } p < r \text{ and all } (F, G, H) \text{ in } T_p^r,\\
						% \sum_{f \in F} i_f + \sum_{g \in G} j_g \le \sum_{h \in H} k_h + p(p+1)/2 \Bigr\},
						T_r^{N'} \triangleq \Bigl\{(I, J, K) \in U_r^{N'} \mid \forall p < r, (F, G, H) \in T_p^r,\\
						\sum_{f \in F} i_f + \sum_{g \in G} j_g \le \sum_{h \in H} k_h + p(p+1)/2 \Bigr\},
					\end{gathered}
				\end{equation*}
				\begin{equation*}
					U_r^{N'} \triangleq \Bigl\{(I, J, K) \mid \sum_{i \in I} i + \sum_{j \in J} j = \sum_{k \in K} k + r(r+1)/2\Bigr\}.
				\end{equation*}
			\end{corollary}
			\begin{proof}
				Please refer to \cite[Theorem 8]{Fulton2000}. This implies the Corollaries~\ref{co:largest_singular_value} and \ref{co:product_singular_values}.
			\end{proof}

			\begin{corollary}[Upper bound on the largest singular value]\label{co:largest_singular_value}
				\begin{equation}
					\sigma_1(\mathbf{H}) \le \sigma_1(\mathbf{H}_\mathrm{B}) \sigma_1(\mathbf{H}_\mathrm{F}).
				\end{equation}
			\end{corollary}

			% \begin{corollary}[lower bound on the smallest singular value]
			% 	\begin{equation}
			% 		\sigma_{N'}(\mathbf{H}) \ge \sigma_{N'}(\mathbf{H}_\mathrm{B}) \sigma_{N'}(\mathbf{H}_\mathrm{F}).
			% 	\end{equation}
			% \end{corollary}

			\begin{corollary}[Upper bound on the product of first $k$ singular values]\label{co:product_singular_values}
				\begin{equation}
					\prod_{n=1}^k \sigma_n(\mathbf{H}) \le \prod_{n=1}^k \sigma_n(\mathbf{H}_\mathrm{B}) \prod_{n=1}^k \sigma_n(\mathbf{H}_\mathrm{F}).
				\end{equation}
			\end{corollary}

			% \begin{corollary}[lower bound on the product of last $k$ singular values]
			% 	\begin{equation}
			% 		\prod_{n=N'}^{N'-k+1} \sigma_n(\mathbf{H}) \ge \prod_{n=N'}^{N'-k+1} \sigma_n(\mathbf{H}_\mathrm{B}) \prod_{n=N'}^{N'-k+1} \sigma_n(\mathbf{H}_\mathrm{F}).
			% 	\end{equation}
			% \end{corollary}

			\begin{corollary}[Upper bound on the sum of first $k$ singular values to the power of $p$\label{co:sum_power}]
				\begin{equation}
					\sum_{n=1}^k \sigma_n^p(\mathbf{H}) \le \sum_{n=1}^k \sigma_n^p(\mathbf{H}_\mathrm{B}) \sigma_n^p(\mathbf{H}_\mathrm{F}), \quad p > 0.
					\label{iq:sv_bound_fc_power}
				\end{equation}
				When $k = N'$ and $p = 2$, \eqref{iq:sv_bound_fc_power} suggests the channel power is upper bounded by the sum of (sorted) element-wise power product of backward and forward subchannels.
			\end{corollary}
			\begin{proof}
				Please refer to \cite[Inequality 24.4.7]{Hogben2013}.
			\end{proof}

			\begin{remark}
				It is straightforward to verify \eqref{iq:sv_bound_fc}--\eqref{iq:sv_bound_fc_power} are simultaneously tight when
				\begin{equation}
					\mathbf{\Theta} = \mathbf{V}_\mathrm{B} \mathbf{U}_\mathrm{F}^\mathsf{H}.
					\label{eq:scattering_fc_tight}
				\end{equation}
				where $\mathbf{V}_\mathrm{B}$ and $\mathbf{U}_\mathrm{F}$ are the right and left compact singular matrices of $\mathbf{H}_\mathrm{B}$ and $\mathbf{H}_\mathrm{F}$, respectively.
			\end{remark}

			Tight bounds are inapplicable when a \gls{mimo} direct link is present, as the \gls{ris} needs to balance the direct-indirect (additive) and backward-forward (multiplicative) subspace alignments.
			Such a balance often involves optimization approaches discussed in Section~\ref{sc:pareto_frontier}. Another example will be discussed in Section~\ref{sc:low_complexity}.
		\end{subsubsection}

	\end{subsection}

	\begin{subsection}{Achievable Rate Maximization}\label{sc:rate}
		The \gls{mimo} achievable rate maximization problem can be formulated with respect to joint active and passive beamforming.
		This problem is different from channel shaping because the \gls{ris} is jointly design with the transmitter for an explicit objective
		\begin{maxi!}
			{\scriptstyle{\mathbf{W},\mathbf{\Theta}}}{R = \log \det \biggl(\mathbf{I} + \frac{\mathbf{W}^\mathsf{H}\mathbf{H}^\mathsf{H}\mathbf{H}\mathbf{W}}{\eta}\biggr)}{\label{op:rate}}{\label{ob:rate}}
			\addConstraint{\lVert \mathbf{W} \rVert _\mathrm{F}^2 \le P}{}{}
			\addConstraint{\mathbf{\Theta}_g^\mathsf{H} \mathbf{\Theta}_g=\mathbf{I}, \quad \forall g,}{}{}
		\end{maxi!}
		where $\mathbf{W}$ is the transmit precoder, $R$ is the achievable rate, $\eta$ is the noise power, and $P$ is the transmit power budget.
		Next, we propose a local-optimal solution based on joint \gls{ris}-transceiver design and a low-complexity decoupled solution based on channel shaping.

		\begin{subsubsection}{Alternating Optimization}
			Consider an \gls{ao} approach that updates $\mathbf{\Theta}$ and $\mathbf{W}$ iteratively.
			For a given $\mathbf{W}$, the passive beamforming subproblem is
			\begin{maxi!}
				{\scriptstyle{\mathbf{\Theta}}}{\log \det \biggl(\mathbf{I} + \frac{\mathbf{H} \mathbf{Q} \mathbf{H}^\mathsf{H}}{\eta}\biggr)}{\label{op:rate_passive}}{\label{ob:rate_passive}}
				\addConstraint{\mathbf{\Theta}_g^\mathsf{H} \mathbf{\Theta}_g=\mathbf{I}, \quad \forall g,}{}{}
			\end{maxi!}
			where $\mathbf{Q} \triangleq \mathbf{W} \mathbf{W}^\mathsf{H}$ is the transmit covariance matrix.
			\begin{lemma}\label{lm:rate_gradient}
				The Euclidean gradient of \eqref{ob:rate_passive} with respect to \gls{bd}-\gls{ris} block $g$ is
				\begin{equation}
					\frac{\partial R}{\partial \mathbf{\Theta}_g^*} = \frac{1}{\eta} \mathbf{H}_{\mathrm{B},g}^\mathsf{H} \biggl(\mathbf{I} + \frac{\mathbf{H}\mathbf{Q}\mathbf{H}^\mathsf{H}}{\eta}\biggr)^{-1} \mathbf{H} \mathbf{Q} \mathbf{H}_{\mathrm{F},g}^\mathsf{H}.
					\label{eq:rate_gradient}
				\end{equation}
			\end{lemma}

			\begin{proof}
				Please refer to Appendix~\ref{ap:rate_gradient}.
			\end{proof}
			Algorithm \ref{ag:rcg} is then invoked to solve problem \eqref{op:rate} where line \ref{ln:gradient_euclidean} uses \eqref{eq:rate_gradient} explicitly.
			Since \eqref{ob:rate_passive} is a concave function of $\mathbf{\Theta}$, convergence to local-optimal points is guaranteed.
			On the other hand, the global optimal transmit precoder for a fixed $\mathbf{\Theta}$ is given by the eigenmode transmission \cite{Clerckx2013}
			\begin{equation}
				\mathbf{W}^\star = \mathbf{V} {\mathbf{S}^\star}^{1/2},
				\label{eq:precoder_eigenmode}
			\end{equation}
			where $\mathbf{V}$ is the right channel singular matrix and $\mathbf{S}^\star$ is the optimal water-filling power allocation matrix.
			The overall \gls{ao} algorithm converges to local-optimal points of problem \eqref{op:rate} since each subproblem is solved optimally and the objective is bounded above.
		\end{subsubsection}

		\begin{subsubsection}{Low-Complexity Solution}\label{sc:low_complexity}
			We then propose a low-complexity solution to problem \eqref{op:rate} based on channel shaping.
			The passive beamforming subproblem \eqref{op:rate_passive} involves transmit covariance matrix $\mathbf{Q}$ and thus requires iterative \gls{rcg} update.
			Instead, we decouple the joint \gls{ris}-transceiver design by recasting \eqref{op:rate_passive} as channel power maximization
			\begin{maxi!}
				{\scriptstyle{\mathbf{\Theta}}}{\lVert \mathbf{H}_\mathrm{D} + \mathbf{H}_\mathrm{B} \mathbf{\Theta} \mathbf{H}_\mathrm{F} \rVert _\mathrm{F}^2}{\label{op:power_passive}}{\label{ob:power_passive}}
				\addConstraint{\mathbf{\Theta}_g^\mathsf{H} \mathbf{\Theta}_g=\mathbf{I}, \quad \forall g.}{}{}
			\end{maxi!}
			% which only accounts for channel characteristics but has no trivial solution.
			\begin{remark}
				As mentioned in Section \ref{sc:bounds}, the key of solving \eqref{op:power_passive} is to balance the additive and multiplicative subspace alignments.
				Problem \eqref{op:power_passive} is very similar (in terms of maximizing the inner product of $\mathbf{H}_\mathrm{D}$ and $\mathbf{H}_\mathrm{B} \mathbf{\Theta} \mathbf{H}_\mathrm{F}$) to the weighted orthogonal Procrustes problem \cite{Gower2004}
				\begin{mini!}
					{\scriptstyle{\mathbf{\Theta}}}{\lVert \mathbf{H}_\mathrm{D} - \mathbf{H}_\mathrm{B} \mathbf{\Theta} \mathbf{H}_\mathrm{F} \rVert _\mathrm{F}^2}{\label{op:weighted_orthogonal_procrustes}}{}
					\addConstraint{\mathbf{\Theta}^\mathsf{H} \mathbf{\Theta}=\mathbf{I},}{}{}
				\end{mini!}
				which has no trivial solution.
				One lossy transformation, by moving $\mathbf{\Theta}$ to one side \cite{Bell2003}, formulates standard orthogonal Procrustes problems
				\begin{mini!}
					{\scriptstyle{\mathbf{\Theta}}}{\lVert \mathbf{H}_\mathrm{B}^\dagger \mathbf{H}_\mathrm{D} - \mathbf{\Theta} \mathbf{H}_\mathrm{F} \rVert _\mathrm{F}^2 \text{ or } \lVert \mathbf{H}_\mathrm{D} \mathbf{H}_\mathrm{F}^\dagger - \mathbf{H}_\mathrm{B} \mathbf{\Theta} \rVert _\mathrm{F}^2}{\label{op:standard_orthogonal_procrustes}}{}
					\addConstraint{\mathbf{\Theta}^\mathsf{H} \mathbf{\Theta}=\mathbf{I},}{}{}
				\end{mini!}
				which has global optimal solutions
				\begin{equation}
					\mathbf{\Theta}^\star = \mathbf{U} \mathbf{V}^\mathsf{H}
					\label{eq:orthogonal_procrustes_solution}
				\end{equation}
				where $\mathbf{U}$ and $\mathbf{V}$ are the left and right singular matrices of $\mathbf{H}_\mathrm{B}^\dagger \mathbf{H}_\mathrm{D} \mathbf{H}_\mathrm{F}^\mathsf{H}$ or $\mathbf{H}_\mathrm{B}^\mathsf{H} \mathbf{H}_\mathrm{D} \mathbf{H}_\mathrm{F}^\dagger$ \cite{Golub2013}.
				It is worth noticing this suboptimal one-step solution only applies to fully-connected \gls{bd}-\gls{ris}.
			\end{remark}

			Inspired by \cite{Nie2017}, we propose a solution to problem \eqref{op:power_passive} with arbitrary group size.
			The idea is to successively approximate the quadratic objective \eqref{ob:power_passive} by local Taylor expansions and solve each step in closed form.

			\begin{proposition}\label{pp:power}
				Starting from any $\mathbf{\Theta}^{(0)} \in \mathbb{U}^{N_\mathrm{S} \times N_\mathrm{S}}$, the sequence
				\begin{equation}
					\mathbf{\Theta}_g^{(r+1)} = \mathbf{U}_g^{(r)} \mathbf{V}_g^{(r)}, \quad \forall g.
					\label{eq:scattering_power}
				\end{equation}
				converges to a stationary point of \eqref{op:power_passive}, where $\mathbf{U}_g^{(r)}$ and $\mathbf{V}_g^{(r)}$ are the left and right compact singular matrix of
				\begin{equation}
					\mathbf{M}_g^{(r)} = \mathbf{H}_{\mathrm{B},g}^\mathsf{H} \Bigl(\mathbf{H}_\mathrm{D} + \mathbf{H}_\mathrm{B} \mathrm{diag}\bigl(\mathbf{\Theta}_{[1:g-1]}^{(r+1)},\mathbf{\Theta}_{[g:G]}^{(r)}\bigr) \mathbf{H}_\mathrm{F}\Bigr) \mathbf{H}_{\mathrm{F},g}^\mathsf{H}
					\label{eq:auxiliary_matrix_power}
				\end{equation}
			\end{proposition}

			\begin{proof}
				Please refer to Appendix~\ref{ap:power}.
			\end{proof}
			Once the channel shaping problem \eqref{op:power_passive} is solved, the transmit precoder can be obtained by \eqref{eq:precoder_eigenmode}.
			This two-stage approach decouples both blocks and is computationally more efficient than the geodesic \gls{rcg} method.
		\end{subsubsection}
	\end{subsection}
\end{section}

\begin{section}{\glsfmtshort{mimo}-\glsfmtshort{ic}}
	\begin{subsection}{System Model}
		We then shift the focus to an $N_\mathrm{S}$-element \gls{bd}-\gls{ris}-aided interference \gls{mimo} system of $K$ transmitter-receiver pairs, where each transmitter is equipped with $N_\mathrm{T}$ antennas and each receiver is equipped with $N_\mathrm{R}$ antennas.
		Let $\mathbf{H}_\mathrm{D}^{[kj]} \in \mathbb{C}^{N_\mathrm{R} \times N_\mathrm{T}}$, $\mathbf{H}_\mathrm{B}^{[k]} \in \mathbb{C}^{N_\mathrm{R} \times N_\mathrm{S}}$, $\mathbf{H}_\mathrm{F}^{[j]} \in \mathbb{C}^{N_\mathrm{S} \times N_\mathrm{T}}$ denote respectively the direct channel from transmitter $j$ to receiver $k$, backward channel of receiver $k$, and forward channel of transmitter $j$, where $j, k \in \{1,\ldots,K\} \triangleq \mathcal{K}$.
		It is assumed that all devices are at the same side of the \gls{ris} and share a common scattering matrix $\mathbf{\Theta}$.
		The equivalent channel from transmitter $j$ to receiver $k$ is
		\begin{equation}
			\mathbf{H}^{[kj]} = \mathbf{H}_\mathrm{D}^{[kj]} + \mathbf{H}_\mathrm{B}^{[k]} \mathbf{\Theta} \mathbf{H}_\mathrm{F}^{[j]} = \mathbf{H}_\mathrm{D}^{[kj]} + \sum_g \mathbf{H}_{\mathrm{B},g}^{[k]} \mathbf{\Theta}_g \mathbf{H}_{\mathrm{F},g}^{[j]},
			\label{eq:channel_equivalent_ic}
		\end{equation}
		where $\mathbf{H}_{\mathrm{B},g}^{[k]} \in \mathbb{C}^{N_\mathrm{R} \times L}$ and $\mathbf{H}_{\mathrm{F},g}^{[j]} \in \mathbb{C}^{L \times N_\mathrm{T}}$ are associated with \gls{ris} group $g$.
	\end{subsection}
	\begin{subsection}{Leakage Interference Minimization}
		Leakage interference refers to the sum of all interference terms in \gls{ic}.
		Assume all transmitter sends $N_\mathrm{E} \le N \triangleq \min(N_\mathrm{T}, N_\mathrm{R})$ data streams to its intended receiver.
		The leakage interference minimization problem is formulated with respect to all transmit precoders, all receiver combiners, and the scattering matrix as
		\begin{mini!}
			{\scriptstyle{\mathbf{\Theta}, \{\mathbf{G}_k\}, \{\mathbf{W}_k\}}}{\mathop{\sum\sum}_{j \neq k} \left\lVert \mathbf{G}_k (\mathbf{H}^{[kj]}_\mathrm{D} + \mathbf{H}^{[k]}_\mathrm{B} \mathbf{\Theta} \mathbf{H}^{[j]}_{\mathrm{F}}) \mathbf{W}_j \right\rVert _{\mathrm{F}}^2}{\label{op:leakage}}{}
			\addConstraint{\mathbf{\Theta}_g^\mathsf{H} \mathbf{\Theta}_g=\mathbf{I}, \quad}{\forall g}{\label{co:scatter}}
			\addConstraint{\mathbf{G}_k \mathbf{G}_k^\mathsf{H}=\mathbf{I}, \quad}{\forall k}{\label{co:combiner}}
			\addConstraint{\mathbf{W}_j^\mathsf{H} \mathbf{W}_j=\mathbf{I}, \quad}{\forall j,}{\label{co:precoder}}
		\end{mini!}
		where $\mathbf{G}_k \in \mathbb{C}^{N_\mathrm{D} \times N_\mathrm{R}}$ is the combiner at receiver $k$ and $\mathbf{W}_j \in \mathbb{C}^{N_\mathrm{T} \times N_\mathrm{D}}$ is the precoder at transmitter $j$.
		It is worth noting that $\mathbf{\Theta}_g$ is a square unitary matrix and $\mathbf{\Theta}_g^\mathsf{H} \mathbf{\Theta}_g=\mathbf{I}$ is equivalent to $\mathbf{\Theta}_g \mathbf{\Theta}_g^\mathsf{H}=\mathbf{I}$, while $\mathbf{G}_k$ and $\mathbf{W}_j$ may be respectively ``fat'' and ``tall'' rectangular semi-unitary matrices such that \eqref{co:combiner} and \eqref{co:precoder} are required.
		The non-convex problem can be solved iteratively by the \gls{bcd} method detailed below.

		\begin{subsubsection}{Combiner and Precoder Design}
			For a given $\mathbf{\Theta}$, problem \eqref{op:leakage} reduces to conventional linear beamforming problem, for which an iterative algorithm alternating between the original and reciprocal networks is proposed in \cite{Gomadam2011,Clerckx2013}.
			At iteration $r$, the combiner at receiver $k$ is updated as
			\begin{equation}
				\mathbf{G}_k^{(r)} = {\mathbf{U}_{k,N}^{(r-1)}}^\mathsf{H},
				\label{eq:combiner_leakage}
			\end{equation}
			where $\mathbf{U}_{k,N}^{(r-1)}$ is the eigenvectors corresponding to $N$ smallest eigenvalues of the interference covariance matrix $\mathbf{Q}_k^{(r-1)} = \sum_{j \ne k} {\mathbf{H}^{[kj]}} \mathbf{W}_j^{(r-1)} {\mathbf{W}_j^{(r-1)}}^\mathsf{H} {\mathbf{H}^{[kj]}}^\mathsf{H}$.
			The precoder at transmitter $j$ is updated as
			\begin{equation}
				\mathbf{W}_j^{(r)} = \bar{\mathbf{U}}_{j,N}^{(r)},
				\label{eq:precoder_leakage}
			\end{equation}
			where $\bar{\mathbf{U}}_{j,N}^{(r)}$ corresponds $\bar{\mathbf{Q}}_j^{(r)} = \sum_{k \ne j} {\mathbf{H}^{[kj]}}^\mathsf{H} {\mathbf{G}_k^{(r)}}^\mathsf{H} \mathbf{G}_k^{(r)} {\mathbf{H}^{[kj]}}$ in the reciprocal network.
		\end{subsubsection}

		\begin{subsubsection}{Scattering Matrix Design}
			Once $\{\mathbf{G}_k\}$ and $\{\mathbf{W}_j\}$ are determined, we define $\bar{\mathbf{H}}^{[kj]}_\mathrm{D} \triangleq \mathbf{G}_k \mathbf{H}^{[kj]}_\mathrm{D} \mathbf{W}_j$, $\bar{\mathbf{H}}^{[k]}_\mathrm{B} \triangleq \mathbf{G}_k \mathbf{H}^{[k]}_\mathrm{B}$, and $\bar{\mathbf{H}}^{[j]}_\mathrm{F} \triangleq \mathbf{H}^{[j]}_\mathrm{F} \mathbf{W}_j$.
			The \gls{bd}-\gls{ris} subproblem boils down to
			\begin{mini!}
				{\scriptstyle{\mathbf{\Theta}}}{\mathop{\sum\sum}_{j \neq k} \left\lVert (\bar{\mathbf{H}}^{[kj]}_\mathrm{D} + \bar{\mathbf{H}}^{[k]}_\mathrm{B} \mathbf{\Theta} \bar{\mathbf{H}}^{[j]}_\mathrm{F}) \right\rVert _{\mathrm{F}}^2}{\label{op:ic_interference_ris}}{}
				\addConstraint{\mathbf{\Theta}_g^\mathsf{H} \mathbf{\Theta}_g=\mathbf{I}, \quad \forall g,}{}{}
			\end{mini!}
			which can be viewed as a channel shaping problem on $\bar{\mathbf{H}}^{[kj]}_\mathrm{D}$, $\bar{\mathbf{H}}^{[k]}_\mathrm{B}$, and $\bar{\mathbf{H}}^{[j]}_\mathrm{F}$.

			\begin{proposition}
				Start from any $\mathbf{\Theta}^{(0)}$, the sequence
				\begin{equation}
					\mathbf{\Theta}_g^{(r+1)} = \mathbf{U}_g^{(r)} \mathbf{V}_g^{(r)}, \quad \forall g
					\label{eq:scatter_leakage}
				\end{equation}
				converges to a stationary point of \eqref{op:ic_interference_ris}, where $\mathbf{U}_g^{(r)}$ and $\mathbf{V}_g^{(r)}$ are left and right singular matrix of
				\begin{equation}
					\mathbf{M}_g^{(r)} = \mathop{\sum\sum}_{j \neq k} \bigl(\mathbf{B}_{k,g} \mathbf{\Theta}_g^{(r)} \mathbf{H}^{[j]}_{\mathrm{F},g} - {\mathbf{H}^{[k]}_{\mathrm{B},g}}^\mathsf{H} {\mathbf{D}^{[kj]}_{g}}^{(r)}\bigr) {\mathbf{H}^{[j]}_{\mathrm{F},g}}^\mathsf{H},
				\end{equation}
				where $\mathbf{B}_{k,g} = \lambda_1\bigl({\mathbf{H}^{[k]}_{\mathrm{B},g}}^\mathsf{H} \mathbf{H}^{[k]}_{\mathrm{B},g}\bigr) \mathbf{I} - {\mathbf{H}^{[k]}_{\mathrm{B},g}}^\mathsf{H} \mathbf{H}^{[k]}_{\mathrm{B},g}$ and
				\begin{equation}
					{\mathbf{D}^{[kj]}_{g}}^{(r)} = \mathbf{H}^{[jk]}_\mathrm{D} + \sum_{g'<g} {\mathbf{H}_{k,g'}^\mathrm{B}}^\mathsf{H} \mathbf{\Theta}_{g'}^{(r+1)} \mathbf{H}_{k,g'}^\mathrm{F} + \sum_{g'>g} {\mathbf{H}_{k,g'}^\mathrm{B}}^\mathsf{H} \mathbf{\Theta}_{g'}^{(r)} \mathbf{H}_{k,g'}^\mathrm{F}.
				\end{equation}
			\end{proposition}
			\begin{proof}
				The proof is similar to Appendix~\ref{ap:power} and omitted here.
			\end{proof}
		\end{subsubsection}

		Problem \eqref{op:leakage} can be solved iteratively by \eqref{eq:combiner_leakage}, \eqref{eq:precoder_leakage}, and \eqref{eq:scatter_leakage}.
		Convergence to local-optimal points is guaranteed since each subproblem is solved optimally and the objective is bounded above.

	\end{subsection}

	\begin{subsection}{Weighted Sum-Rate Maximization}
		Finally, we consider weighted sum-rate maximization in \gls{mimo}-\gls{ic} by joint active and passive beamforming design.
		The achievable rate of transmission $k$ is given by
		\begin{equation}
			R_k = \log \det \biggl(\mathbf{I} + \mathbf{W}_k {\mathbf{H}^{[kj]}}^\mathsf{H} \mathbf{Q}_k^{-1} {\mathbf{H}^{[kj]}} \mathbf{W}_k\biggr),
		\end{equation}
		where $\mathbf{Q}_k$ is the interference-plus-noise covariance matrix at receiver $k$
		\begin{equation}
			\mathbf{Q}_k = \sum_{j \ne k} {\mathbf{H}^{[kj]}} \mathbf{W}_j {\mathbf{W}_j}^\mathsf{H} {\mathbf{H}^{[kj]}}^\mathsf{H} + \eta \mathbf{I},
		\end{equation}
		and $\eta$ is the average noise power.
		The optimization problem is formulated as
		\begin{maxi!}
			{\scriptstyle{\mathbf{\Theta}, \{\mathbf{W}_k\}}}{\sum_k \rho_k R_k}{\label{op:ic_rate}}{\label{ob:ic_rate}}
			\addConstraint{\mathbf{\Theta}_g^\mathsf{H} \mathbf{\Theta}_g=\mathbf{I}, \quad \forall g}{}{}
			\addConstraint{\lVert \mathbf{W}_k \rVert _\mathrm{F}^2 \le P_k. \quad \forall k}{}{}
		\end{maxi!}
		where $\rho_k$ is the weight of transmission $k$.
		The problem is non-convex and can be solved by the \gls{ao} method detailed below.

		\begin{subsubsection}{Precoder Design}
			For a given $\mathbf{\Theta}$, \eqref{op:ic_rate} reduces to conventional linear beamforming problem, for which a closed-form iterative solution has been proposed in \cite{Negro2010} based on mutual information-\gls{mmse} relationship \cite{Guo2005}.
			We restate the steps as follows.

			At iteration $r$, the \gls{mmse} combiner at receiver $k$ is
			\begin{equation}
				\mathbf{G}_k^{(r)} = {\mathbf{W}_k^{(r-1)}}^\mathsf{H} {\mathbf{H}^{[kk]}}^\mathsf{H} \bigl(\mathbf{Q}_k^{(r-1)} + {\mathbf{H}^{[kk]}} \mathbf{W}_k^{(r-1)} {\mathbf{W}_k^{(r-1)}}^\mathsf{H} {\mathbf{H}^{[kk]}}^\mathsf{H}\bigr)^{-1},
			\end{equation}
			the corresponding error matrix is
			\begin{equation}
				\mathbf{E}_k^{(r)} = \bigl(\mathbf{I} + {\mathbf{W}_k^{(r-1)}}^\mathsf{H} {\mathbf{H}^{[kk]}}^\mathsf{H} \mathbf{Q}_k^{(r-1)} {\mathbf{H}^{[kk]}} \mathbf{W}_k^{(r-1)}\bigr)^{-1},
			\end{equation}
			the \gls{mse} weight is
			\begin{equation}
				\mathbf{\Omega}_k^{(r)} = \rho_k {\mathbf{E}_k^{(r)}}^{-1},
			\end{equation}
			the Lagrange multiplier is
			\begin{equation}
				\lambda_k^{(r)} = \frac{\mathrm{tr}\bigl(\eta \mathbf{\Omega}_k^{(r)} \mathbf{G}_k^{(r)}{\mathbf{G}_k^{(r)}}^\mathsf{H} + \sum_j \mathbf{\Omega}_k^{(r)}\mathbf{T}_{kj}^{(r)} {\mathbf{T}_{kj}^{(r)}}^\mathsf{H} - \mathbf{\Omega}_j^{(r)}\mathbf{T}_{jk}^{(r)} {\mathbf{T}_{jk}^{(r)}}^\mathsf{H} \bigr)}{P_k},
			\end{equation}
			where $\mathbf{T}_{kj}^{(r)} = \mathbf{G}_k^{(r)} {\mathbf{H}^{[kj]}} \mathbf{W}_j^{(r)}$.
			The optimal precoder at transmitter $k$ is given by
			\begin{equation}
				\mathbf{W}_k^{(r)} = \Bigl(\sum_j {\mathbf{H}^{[jk]}}^\mathsf{H} {\mathbf{G}_j^{(r)}}^\mathsf{H} \mathbf{\Omega}_k^{(r)} \mathbf{G}_j^{(r)} \mathbf{H}^{[jk]} + \lambda_k^{(r)} \mathbf{I} \Bigr)^{-1} {\mathbf{H}^{[kk]}}^\mathsf{H} {\mathbf{G}_j^{(r)}}^\mathsf{H} \mathbf{\Omega}_k^{(r)}.
			\end{equation}
		\end{subsubsection}

		\begin{subsubsection}{Scattering Matrix Design}
			Once $\{\mathbf{W}_k\}$ is determined, the complex derivative of \eqref{ob:ic_rate} with respect to \gls{ris} block $g$ is
			\begin{equation}
				\frac{\partial \rho_k R_k}{\partial \mathbf{\Theta}_g^*} = \sum_k \rho_k {\mathbf{H}^{[k]}_{\mathrm{B},g}}^\mathsf{H} \mathbf{Q}_k^{-1} {\mathbf{H}^{[kk]}} \mathbf{W}_k \mathbf{E}_k \mathbf{W}_k^\mathsf{H} \bigl({\mathbf{H}_{k,g}^\mathrm{F}}^\mathsf{H} - {\mathbf{H}^{[kk]}}^\mathsf{H} \mathbf{Q}_k^{-1} \sum_{j \ne k} {\mathbf{H}^{[kj]}} \mathbf{W}_j \mathbf{W}_j^\mathsf{H} {\mathbf{H}^{[j]}_{\mathrm{F},g}}^\mathsf{H}\bigr).
				\label{eq:ic_rate_gradient_ris}
			\end{equation}
		\end{subsubsection}
		The \gls{ris} subproblem can be solved by \gls{rcg} Algorithm~\ref{ag:rcg} where line \ref{ln:gradient_euclidean} uses \eqref{eq:ic_rate_gradient_ris} explicitly.
	\end{subsection}
\end{section}


\begin{section}{Simulation Results}\label{sc:simulation}
	In this section, we provide numerical results to evaluate the proposed \gls{bd}-\gls{ris} designs.
	Consider a distance-dependent path loss model $\Lambda(d) = \Lambda_0 d^{-\gamma}$ where $\Lambda_0$ is the reference path loss at distance \qty{1}{m}, $d$ is the propagation distance, and $\gamma$ is the path loss exponent.
	The small-scale fading model is $\mathbf{H} = \sqrt{\kappa/(1+\kappa)} \mathbf{H}_\text{LoS} + \sqrt{1/(1+\kappa)} \mathbf{H}_\text{NLoS}$, where $\kappa$ is the Rician $K$-factor, $\mathbf{H}_\text{LoS}$ is the deterministic \gls{los} component, and $\mathbf{H}_\text{NLoS} \sim \mathcal{CN}(\mathbf{0}, \mathbf{I})$ is the Rayleigh component.
	We set $\Lambda_0=\qty{-30}{dB}$, $d_\mathrm{D}=\qty{14.7}{m}$, $d_\mathrm{F}=\qty{10}{m}$, $d_\mathrm{B}=\qty{6.3}{m}$, $\gamma_\mathrm{D}=3$, $\gamma_\mathrm{F}=2.4$ and $\gamma_\mathrm{B}=2$ for reference, which corresponds to a typical indoor environment with $\Lambda_\mathrm{D}=\qty{-65}{dB}$, $\Lambda_\mathrm{F}=\qty{-54}{dB}$, $\Lambda_\mathrm{B}=\qty{-46}{dB}$.
	The indirect path via \gls{ris} is thus \qty{35}{\dB} weaker than the direct path.
	$\kappa \to \infty$ is assumed for all channels unless otherwise specified.

	\begin{subsection}{Algorithm Evaluation}
		\begin{table}[H]
			\footnotesize
			\caption{Average performance of \gls{rcg} algorithms on problem \eqref{op:pareto}. Minimum relative gain per iteration $\epsilon=\num{e-4}$ and number of channel realizations $T=100$.}
			\label{tb:complexity_test}
			\centering
			\begin{tabular}{ccccccc}
				\toprule
				\multirow{2}{*}{\gls{rcg} path} & \multicolumn{3}{c}{$N_\mathrm{S}=16$} & \multicolumn{3}{c}{$N_\mathrm{S}=256$}                                                                 \\ \cmidrule(lr){2-4} \cmidrule(lr){5-7}
												& Objective                              & Iterations                             & Time [s]         & Objective        & Iterations & Time [s]  \\ \midrule
				Geodesic                        & $\num{4.355e-3}$                       & 11.61                                  & $\num{2.038e-2}$ & $\num{1.164e-2}$ & 25.78      & 3.216     \\
				Non-geodesic                    & $\num{4.168e-3}$                       & 169.5                                  & $\num{1.420e-1}$ & $\num{8.873e-3}$ & 278.1      & 27.81     \\ \bottomrule
			\end{tabular}
		\end{table}

		We first compare the proposed geodesic \gls{rcg} algorithm with the general non-geodesic approach \cite{Absil2009,Pan2022d} on problem \eqref{op:pareto}.
		It is observed that the geodesic \gls{rcg} algorithm achieves a slightly higher objective value with significantly (around 10$\times$) lower number of iterations and shorter computational time than the non-geodesic one.
		The results suggest that the proposed optimization framework is very efficient for asymmetric \gls{bd}-\gls{ris} design.
		If the scattering matrix has to be symmetric, one can project the solution to the feasible domain by $\mathbf{\Theta} \gets (\mathbf{\Theta} + \mathbf{\Theta}^\mathsf{T})/2$.
	\end{subsection}


	\begin{subsection}{\glsfmtshort{mimo}-\glsfmtshort{pc}}
		\begin{subsubsection}{Pareto Frontier}
			\begin{figure}[H]
				\centering
				\subfloat[$2 \times 32 \times 2$ (no direct)\label{fg:singular_pareto_sx32_nd}]{
					\resizebox{0.45\columnwidth}{!}{
						\input{assets/chapter_5/singular_pareto_sx32_nd.tex}
					}
				}
				\subfloat[$2 \times 32 \times 2$\label{fg:singular_pareto_sx32}]{
					\resizebox{0.45\columnwidth}{!}{
						\input{assets/chapter_5/singular_pareto_sx32.tex}
					}
				}
				\\
				\subfloat[$2 \times 64 \times 2$\label{fg:singular_pareto_sx64}]{
					\resizebox{0.45\columnwidth}{!}{
						\input{assets/chapter_5/singular_pareto_sx64.tex}
					}
				}
				\subfloat[$2 \times 128 \times 2$\label{fg:singular_pareto_sx128}]{
					\resizebox{0.45\columnwidth}{!}{
						\input{assets/chapter_5/singular_pareto_sx128.tex}
					}
				}
				\caption{Pareto frontiers of singular values of a 2T2R channel reshaped by a \gls{ris}.}
				\label{fg:singular_pareto}
			\end{figure}
			% Fig. \ref{fg:singular_pareto} shows the Pareto frontiers of channel singular values reshaped by \gls{bd}-\gls{ris}.
			Fig. \ref{fg:singular_pareto} shows the Pareto singular values of a 2T2R \gls{mimo} reshaped by a \gls{ris}.
			When the direct link is absent, the achievable regions in Fig. \subref*{fg:singular_pareto_sx32_nd} are shaped like pizza slices.
			This is because $\sigma_1(\mathbf{H}) \ge \sigma_2(\mathbf{H}) \ge 0$ and there exists a trade-off between aligning the two subspaces.
			%  since $\sigma_1(\mathbf{H}) \ge \sigma_2(\mathbf{H}) \ge 0$.
			We observe that the smallest singular value is enhanced up to \num{2e-4} by diagonal \gls{ris} and \num{3e-4} by fully-connected \gls{bd}-\gls{ris}, corresponding to a \qty{50}{\percent} gain.
			When the direct link is present, the shape of the singular value region depends heavily on the relative strength of the indirect link.
			In Fig. \subref*{fg:singular_pareto_sx32}, a 32-element \gls{ris} is insufficient to compensate the \qty{35}{dB} path loss imbalance and results in a limited singular value region that is symmetric around the direct point.
			As the group size $L$ increases, the shape of the region evolves from elliptical to square.
			This transformation not only provides a better trade-off in subchannel manipulation but also improves the dynamic range of $\sigma_1(\mathbf{H})$ and $\sigma_2(\mathbf{H})$ by \qty{22}{\percent} and \qty{38}{\percent}, respectively.
			The achievable singular value region also enlarges as the number of scattering elements $N_\mathrm{S}$ increases.
			In particular, Fig. \subref*{fg:singular_pareto_sx128} shows that the equivalent channel can be completely nulled by a 128-element \gls{bd}-\gls{ris} but not by a diagonal one.
			Those results demonstrate the superior channel shaping capability of \gls{bd}-\gls{ris}.
		\end{subsubsection}

		\begin{subsubsection}{Analytical Bounds and Numerical Results}
			\begin{figure}[H]
				\centering
				\subfloat[$4 \times 32 \times 4$ (rank-1)\label{fg:singular_bound_rank1_sx32}]{
					\resizebox{0.45\columnwidth}{!}{
						\input{assets/chapter_5/singular_bound_rank1_sx32.tex}
					}
				}
				\subfloat[$4 \times 64 \times 4$ (rank-1)\label{fg:singular_bound_rank1_sx64}]{
					\resizebox{0.45\columnwidth}{!}{
						\input{assets/chapter_5/singular_bound_rank1_sx64.tex}
					}
				}
				\\
				\subfloat[$4 \times 128 \times 4$ (rank-2)\label{fg:singular_bound_rank2_sx128}]{
					\resizebox{0.45\columnwidth}{!}{
						\input{assets/chapter_5/singular_bound_rank2_sx128.tex}
					}
				}
				\subfloat[$4 \times 256 \times 4$ (rank-4)\label{fg:singular_bound_rank4_sx256}]{
					\resizebox{0.45\columnwidth}{!}{
						\input{assets/chapter_5/singular_bound_rank4_sx256.tex}
					}
				}
				\caption{
					Achievable channel singular values: analytical bounds (green lines) and numerical optimization results (blue and red bars).
					The intersections of the blue and red bars denote the singular values of the direct channel.
					The blue (resp. red) bars are obtained by solving problem \eqref{op:pareto} with $\rho_n = -1$ (resp. $+1$) and $\rho_{n'} = 0$, $\forall n' \ne n$.
					`D' means diagonal \gls{ris} and `BD' means fully-connected \gls{bd}-\gls{ris}.
					`rank-$k$' refers to the rank of the forward channel.
				}
				\label{fg:singular_bound}
			\end{figure}
			Fig. \ref{fg:singular_bound} illustrates the analytical singular value bounds in Proposition \ref{pp:rank_deficient} and the numerical results obtained by solving problem \eqref{op:pareto} with $\rho_n = \pm 1$ and $\rho_{n'} = 0$, $\forall n' \ne n$.
			Here we assme a rank-$k$ forward channel without loss of generality.
			When the \gls{ris} is in the vicinity of the transmitter, Figs. \subref*{fg:singular_bound_rank1_sx32} and \subref*{fg:singular_bound_rank1_sx64} show that the achievable channel singular values indeed satisfy Corollary \ref{co:los}, namely $\sigma_1(\mathbf{H}) \ge \sigma_1(\mathbf{T})$, $\sigma_2(\mathbf{T}) \le \sigma_2(\mathbf{H}) \le \sigma_1(\mathbf{T})$, etc.
			It is obvious that \gls{bd}-\gls{ris} can approach those bounds better than diagonal \gls{ris} especially for a small $N_\mathrm{S}$.
			% Another example is given in Fig. \subref*{fg:singular_bound_rank2_sx128} where the forward channel is rank-2.
			Another example is given in Fig. \subref*{fg:singular_bound_rank2_sx128} with rank-2 forward channel.
			% The observations align with Proposition \ref{pp:rank_deficient} that t
			The first two channel singular values are unbounded above and bounded below by the first two singular values of $\mathbf{T}$, while the last two singular values can be suppressed to zero and bounded above by the first two singular values of $\mathbf{T}$.
			Those observations align with Proposition \ref{pp:rank_deficient} and Corollary \ref{co:extreme}.
			Finally, Fig. \subref*{fg:singular_bound_rank4_sx256} confirms there are no extra singular value bounds when both forward and backward channels are full-rank.
			This can be predicted from \eqref{eq:auxiliary_matrix} where the compact singular matrix $\mathbf{V}_\mathrm{F}$ becomes unitary and $\mathbf{T}=\mathbf{0}$.
			The numerical results are consistent with the analytical bounds, and we conclude that the channel shaping advantage of \gls{bd}-\gls{ris} over diagonal \gls{ris} scales with forward and backward channel ranks.

			\begin{figure}[H]
				\centering
				\subfloat[$1 \times 256 \times 1$ (no direct)\label{fg:power_bond_txrx1_nd}]{
					\resizebox{0.45\columnwidth}{!}{
						\input{assets/chapter_5/power_bond_txrx1_nd.tex}
					}
				}
				\subfloat[$4 \times 256 \times 4$ (no direct)\label{fg:power_bond_txrx4_nd}]{
					\resizebox{0.45\columnwidth}{!}{
						\input{assets/chapter_5/power_bond_txrx4_nd.tex}
					}
				}
				\caption{
					Average maximum channel power versus \gls{bd}-\gls{ris} group size and \gls{mimo} dimensions.
					`Cascaded' refers to the available power of the cascaded channel, i.e., the sum of (sorted) element-wise power product of backward and forward subchannels.
				}
				\label{fg:power_bond}
			\end{figure}

			Fig. \ref{fg:power_bond} compares the analytical channel power bound in Corollary \ref{co:sum_power} with $k=N'$, $p=2$ and the numerical results obtained by solving problem \eqref{op:power_passive} when the direct link is absent.
			Here, a fully-connected \gls{bd}-\gls{ris} can attain the upper bound either in closed form \eqref{eq:scattering_fc_tight} or via optimization approach \eqref{eq:scattering_power}.
			% Recall that a fully-connected \gls{bd}-\gls{ris} in closed form \eqref{eq:scattering_fc_tight} can attain the bound.
			% We observe that the bound is also tight for fully-connected \gls{bd}-\gls{ris}.
			% Increasing the group size of \gls{bd}-\gls{ris} significantly improves the channel power especially for a large \gls{mimo}.
			% Apparently, \gls{bd}-\gls{ris} with a larger group size can approach the bound better, and a fully-connected one can achieve the bound.
			% The bound here indicates how much power can potentially be extracted from the forward and backward channels.
			% We observe that using a larger group size can approach the bound better, and full
			% We observe that the bound is tight for fully-connected \gls{bd}-\gls{ris} in \gls{siso} and \gls{mimo}.
			For the \gls{siso} case in Fig. \subref*{fg:power_bond_txrx1_nd}, the maximum channel power is approximately \num{4e-6} by diagonal \gls{ris} and \num{6.5e-6} by fully-connected \gls{bd}-\gls{ris}, corresponding to a \qty{62.5}{\percent} gain.
			This aligns with the asymptotic \gls{bd}-\gls{ris} scaling law derived for \gls{siso} in \cite{Shen2020a}.
			Interestingly, the gain surges to \qty{270}{\percent} in 4T4R \gls{mimo} as shown in Fig. \subref*{fg:power_bond_txrx4_nd}.
			This is because subspace alignment boils down to phase matching in \gls{siso} such that both triangular and Cauchy-Schwarz inequalities in \cite[(50)]{Shen2020a} can be simultaneously tight regardless of the group size.
			That is, diagonal \gls{ris} is sufficient for subspace alignment in \gls{siso} while the \qty{62.5}{\percent} gain from \gls{bd}-\gls{ris} comes purely from subchannel rearrangement.
			Now consider a diagonal \gls{ris} in \gls{mimo}.
			Each element can only apply a common phase shift to the associated rank-1 $N_\mathrm{R} \times N_\mathrm{T}$ indirect channel.
			Therefore, perfect subspace alignment of indirect channels through different elements is generally impossible.
			It means the disadvantage of diagonal \gls{ris} in subspace alignment and subchannel rearrangement scales with \gls{mimo} dimensions.
			We thus conclude that the power gain of \gls{bd}-\gls{ris} scales with group size and \gls{mimo} dimensions.
		\end{subsubsection}


		% \begin{subsection}{Channel Singular Values Redistribution}
		% 	% The Pareto singular value frontiers of a $2 \times 2$ \gls{mimo} with a 32-element \gls{bd}-\gls{ris} is shown in Fig.~\ref{fg:singular_pareto}.
		% 	% The Pareto frontier of channel singular values reshaped by \gls{bd}-\gls{ris} is shown in Fig. \ref{fg:singular_pareto}.
		% 	% The Pareto frontier of channel singular values reshaped by \gls{bd}-\gls{ris} is shown in Fig. \ref{fg:singular_pareto}.
		% 	% Clearly, a larger group size provides
		% 	% and evolving trend of channel singular values are shown in Fig.~\ref{fg:singular_pareto} and \ref{fg:pc_singular_bound}.
		% 	% Clearly, \gls{bd}-\gls{ris} with a larger group size can redistribute the channel singular values to a wider range.
		% \end{subsection}

		\begin{subsubsection}{Channel Power and Achievable Rate Maximization}
			\begin{figure}[H]
				\centering
				\subfloat[$16 \times N_\mathrm{S} \times 16$ (no direct)\label{fg:power_sx_txrx16_nd}]{
					\resizebox{0.45\columnwidth}{!}{
						\input{assets/chapter_5/power_sx_txrx16_nd.tex}
					}
				}
				\subfloat[$16 \times N_\mathrm{S} \times 16$\label{fg:power_sx_txrx16}]{
					\resizebox{0.45\columnwidth}{!}{
						\input{assets/chapter_5/power_sx_txrx16.tex}
					}
				}
				\caption{
					Average maximum channel power versus \gls{ris} configuration.
					`OP-left' and `OP-right' refer to the suboptimal solutions to problem \eqref{op:power_passive} by lossy transformation \eqref{op:standard_orthogonal_procrustes} where $\mathbf{\Theta}$ is to the left and right of the product, respectively.
				}
				\label{fg:power_sx}
			\end{figure}

			We first focus on channel shaping subproblem \eqref{op:power_passive}.
			Fig. \ref{fg:power_sx} shows the achievable channel power under different \gls{ris} configurations.
			An interesting observation is that the relative power gain of \gls{bd}-\gls{ris} over diagonal \gls{ris} is even larger with direct link.
			For example, a 64-element fully \gls{bd}-\gls{ris} can almost provide the same channel power as a 256-element diagonal \gls{ris} in Fig. \ref{fg:power_sx_txrx16}, but not in Fig. \ref{fg:power_sx_txrx16_nd}.
			% This again credits to the superior subspace alignment capability of \gls{bd}-\gls{ris}.
			This is because the \gls{ris} needs to balance the multiplicative forward-backward combining and the additive direct-indirect combining, such that the subspace alignment advantage of \gls{bd}-\gls{ris} becomes more pronounced.
			We also notice that the suboptimal solutions \eqref{eq:orthogonal_procrustes_solution} for fully-connected \gls{bd}-\gls{ris} by lossy transformation \eqref{op:standard_orthogonal_procrustes} are very close to optimal especially for a large $N_\mathrm{S}$.

			\begin{figure}[H]
				\centering
				\subfloat[$4 \times 128 \times 4$\label{fg:rate_beamforming}]{
					\resizebox{0.45\columnwidth}{!}{
						\input{assets/chapter_5/rate_beamforming.tex}
					}
				}
				\subfloat[$N_\mathrm{T} \times 128 \times N_\mathrm{R}$\label{fg:rate_txrx}]{
					\resizebox{0.45\columnwidth}{!}{
						\input{assets/chapter_5/rate_txrx.tex}
					}
				}
				\\
				\subfloat[$4 \times N_\mathrm{S} \times 4$\label{fg:rate_sx}]{
					\resizebox{0.45\columnwidth}{!}{
						\input{assets/chapter_5/rate_sx.tex}
					}
				}
				\subfloat[$4 \times 128 \times 4$\label{fg:rate_kfactor}]{
					\resizebox{0.45\columnwidth}{!}{
						\input{assets/chapter_5/rate_kfactor.tex}
					}
				}
				\caption{
					Average achievable rate versus \gls{mimo} and \gls{ris} configurations.
					The noise power is $\eta = \qty{-75}{dB}$, corresponding to a direct \gls{snr} of \num{-10} to \qty{30}{dB}.
					`Alternate' refers to the alternating optimization and `Decouple' refers to the low-complexity design.
					`D' means diagonal \gls{ris} and `BD' means fully-connected \gls{bd}-\gls{ris}.
				}
				\label{fg:rate}
			\end{figure}

			Fig. \ref{fg:rate} presents the achievable rate under different \gls{mimo} and \gls{ris} configurations.
			At a transmit power of \qty{10}{dB}, Fig. \subref*{fg:rate_beamforming} shows that introducing a 128-element diagonal \gls{ris} to 4T4R \gls{mimo} can improve the achievable rate from \qty{22.2}{bps/Hz} to \qty{29.2}{bps/Hz} ($+\qty{31.5}{\percent}$).
			In contrast, a \gls{bd}-\gls{ris} of group size 4 and 128 can further improve the rate to \qty{32.1}{bps/Hz} ($+\qty{44.6}{\percent}$) and \qty{34}{bps/Hz}  ($+\qty{53.2}{\percent}$), respectively.
			Interestingly, the gap between the optimal \gls{ao} approach \eqref{op:rate_passive}--\eqref{eq:precoder_eigenmode} and the low-complexity solution \eqref{eq:scattering_power} and \eqref{eq:precoder_eigenmode} narrows as the group size increases, and completely vanishes for a fully-connected \gls{bd}-\gls{ris}.
			This implies that the \gls{ris}-transceiver design can often be decoupled via channel shaping with marginal performance loss.
			Figs. \subref*{fg:rate_txrx} and \subref*{fg:rate_sx} also confirm the advantage of \gls{bd}-\gls{ris} grows with the number of transmit, scatter, and receive antennas.
			In the low power regime (\num{-20} to \qty{-10}{dB}), the slope of the achievable rate is significantly larger with \gls{bd}-\gls{ris}, suggesting that multiple streams can be activated at a much lower \gls{snr}.
			This is because \gls{bd}-\gls{ris} not only spreads the channel singular values to a wider range, but also provides a better trade-off between subchannels (c.f. Fig. \ref{fg:singular_pareto}).
			Finally, Fig. \subref*{fg:rate_kfactor} shows that the gap between diagonal and \gls{bd}-\gls{ris} narrows as the Rician $K$-factor increases and becomes indistinguishable in \gls{los} environment.
			The observation is expected from previous studies \cite{Shen2020a,Li2023b,Nerini2023} and aligns with Corollary \ref{co:los}, which suggests that the \gls{bd}-\gls{ris} should be deployed in rich-scattering environments to exploit its channel shaping potential.
		\end{subsubsection}
	\end{subsection}

	\begin{subsection}{\glsfmtshort{mimo}-\glsfmtshort{ic}}
		\begin{subsubsection}{Leakage Interference Minimization}
			\begin{figure}[H]
				\centering
				\resizebox{0.65\columnwidth}{!}{
					\input{assets/chapter_5/ic_interference_sx.tex}
				}
				\caption{Average leakage interference versus \gls{ris} elements $N_\mathrm{S}$ and group size $L$. Transmitters and receivers are randomly generated in a disk of radius 50 m centered at the \gls{ris}. $(N_\mathrm{T}, N_\mathrm{R}, N_\mathrm{E}, K) = (8, 4, 3, 5)$.}
				\label{sm:ic_interference_sx}
			\end{figure}
			Fig.~\ref{sm:ic_interference_sx} illustrates how \gls{bd}-\gls{ris} helps to reduce the leakage interference.
			In this case, a fully-connected $2^n$-element \gls{bd}-\gls{ris} is almost as good as a diagonal $2^{n+2}$-element \gls{ris} in terms of leakage interference.
			Interestingly, the result suggests that \gls{bd}-\gls{ris} can achieve a higher \gls{dof} than diagonal \gls{ris} in \gls{mimo}-\gls{ic}, which is not the case in \gls{mimo}-\gls{pc} as discussed in \ref{pp:dof}.
			This demonstrates the potential of \gls{bd}-\gls{ris} in interference alignment or cancellation.
		\end{subsubsection}

		\begin{subsubsection}{Weighted Sum-Rate Maximization}
			\begin{figure}[H]
				\centering
				\resizebox{0.65\columnwidth}{!}{
					\input{assets/chapter_5/ic_rate_sx.tex}
				}
				\caption{Average weighted sum-rate versus average transmit power, \gls{ris} elements $N_\mathrm{S}$, and group size $L$. $(N_\mathrm{T}, N_\mathrm{R}, N_\mathrm{E}, K) = (8, 4, 3, 5)$.}
				\label{sm:ic_rate_sx}
			\end{figure}

			Fig.~\ref{sm:ic_rate_sx} shows the average weighted sum-rate versus average transmit power and \gls{ris} configuration.
			We observe that the advantage of \gls{bd}-\gls{ris} over diagonal \gls{ris} becomes more pronounced when the number of reflecting elements increases.
			This is because the total number of subchannels in the system grows linearly with $N_\mathrm{S}$ such that the gain from subchannel rearrangement capability of \gls{bd}-\gls{ris} is amplified.
			It suggests cooperative scattering among elements is particularly important for large-scale \gls{ris} deployments in \gls{mimo}-\gls{ic} systems, where the performance-complexity trade-off is more favorable than \gls{siso} and single-user scenarios.

			\begin{figure}[H]
				\centering
				\resizebox{0.65\columnwidth}{!}{
					\input{assets/chapter_5/ic_rate_user.tex}
				}
				\caption{Average weighted sum-rate versus transmitter-receiver pairs $K$, \gls{ris} elements $N_\mathrm{S}$, and group size $L$. $(N_\mathrm{T}, N_\mathrm{R}, N_\mathrm{E}) = (4, 4, 3)$, $P = \qty{25}{dB}$, and $\rho_k = 1, \ \forall k$.}
				\label{sm:ic_rate_user}
			\end{figure}

			Fig.~\ref{sm:ic_rate_user} shows the average weighted sum-rate versus the number of transmitter-receiver pairs and \gls{ris} configuration.
			We observe that introducing a \gls{ris} to \gls{ic} systems is helpful to mitigate the rate saturation effect as the number of users increases.
			In the overloaded regime ($K \ge 8$), \gls{bd}-\gls{ris} provides a larger slope of the achievable rate than diagonal \gls{ris}.
			This is because the \gls{bd}-\gls{ris} can better align the interference subspaces of different users, as discussed in Remark \ref{rm:channel_shaping}.
			At $K=10$, adding a 64-element diagonal and \gls{bd}-\gls{ris} can improve the weighted sum-rate by \qty{23}{\percent} and \qty{43}{\percent}, respectively.
			% These results highlight the importance of \gls{ris}, and particularly t configurations, for maximizing the capacity of overloaded multi-user interference channels
			These results provide valuable insights for practical \gls{ris} design in dense connection scenarios, where \gls{bd} configurations can significantly enhance the network capacity.
		\end{subsubsection}
	\end{subsection}
\end{section}

\begin{section}{Conclusion}
	This chapter studied the channel shaping capability of \gls{ris} in \gls{mimo}-\gls{pc} and \gls{ic}.
	We considered a general \gls{bd} architecture that allows elements within the same group to cooperate, enabling advanced wave manipulation than conventional \gls{ris}.
	% This translates to a wider dynamic range (with better trade-off) of channel singular values with significant power and rate gains in \gls{pc}, and lower leakage interference and higher \gls{dof} in \gls{ic}.
	% Those advantages are more pronounced in rich-scattering environments and large-scale systems.
	An efficient \gls{rcg} algorithm was proposed for smooth \gls{bd}-\gls{ris} optimization problems, which offers lower computation complexity and faster convergence than existing methods.
	For \gls{pc}, we characterized the Pareto frontiers of channel singular values via optimization approach and provided analytical bounds in rank-deficient and fully-connected scenarios.
	Two joint beamforming designs were proposed for rate maximization problem, one based on \gls{ao} for optimal performance and one based on channel shaping for lower complexity.
	For \gls{ic}, we highlighted that \gls{bd}-\gls{ris} can reduce the leakage interference and improve the weighted sum-rate.
	Extensive simulation results and theoretical analysis showed that the advantage of \gls{bd}-\gls{ris} scales with the number of elements, group size, \gls{mimo} dimensions, and channel diversity, thanks to its superior subspace alignment and subchannel rearrangement capability.

	One future direction is incorporating one \gls{ris} at transmitter and one at receiver for stronger channel manipulation, which may fully align both direct-indirect and forward-backward subspaces simultaneously.
	% Finally, integrating the \gls{ris} into the \gls{mimo} precoding and combining design is also an interesting topic for future research.
	% into the \gls{mimo} precoding and combining design is also an interesting topic for future research.
	% even better channel shaping can be achieved by incorporating the \gls{ris} into the \gls{mimo} precoding and combining design.
\end{section}
